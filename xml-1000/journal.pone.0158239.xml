<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-16-07824</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0158239</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Hyperpolarization</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Hyperpolarization</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Depolarization</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Depolarization</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cell physiology</subject><subj-group><subject>Junctional complexes</subject><subj-group><subject>Gap junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Synapses</subject><subj-group><subject>Gap junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Synapses</subject><subj-group><subject>Gap junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Gap junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Gap junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Gap junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Waves</subject><subj-group><subject>Wavefronts</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Tissue distribution</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pharmacology</subject><subj-group><subject>Pharmacokinetics</subject><subj-group><subject>Tissue distribution</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Toward a More Efficient Implementation of Antifibrillation Pacing</article-title>
<alt-title alt-title-type="running-head">Toward a More Efficient Implementation of Antifibrillation Pacing</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Wilson</surname> <given-names>Dan</given-names></name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Moehlis</surname> <given-names>Jeff</given-names></name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Department of Mechanical Engineering, University of California Santa Barbara, Santa Barbara, CA 93106, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Panfilov</surname> <given-names>Alexander V</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Gent University, BELGIUM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: DW JM. Performed the experiments: DW. Analyzed the data: DW. Contributed reagents/materials/analysis tools: DW. Wrote the paper: DW JM.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dan.d.wilson8@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>8</day>
<month>7</month>
<year>2016</year>
</pub-date>
<volume>11</volume>
<issue>7</issue>
<elocation-id>e0158239</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>2</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>6</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Wilson, Moehlis</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0158239"/>
<abstract>
<p>We devise a methodology to determine an optimal pattern of inputs to synchronize firing patterns of cardiac cells which only requires the ability to measure action potential durations in individual cells. In numerical bidomain simulations, the resulting synchronizing inputs are shown to terminate spiral waves with a higher probability than comparable inputs that do not synchronize the cells as strongly. These results suggest that designing stimuli which promote synchronization in cardiac tissue could improve the success rate of defibrillation, and point towards novel strategies for optimizing antifibrillation pacing.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>NSF-1363243</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Moehlis</surname> <given-names>Jeff</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by National Science Foundation, NSF-1363243 (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov/" xlink:type="simple">http://www.nsf.gov/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="17"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>While cardiac arrest continues to be a leading cause of death in the industrialized world, for the past century, the only clinically reliable method of defibrillation has been the application of a high voltage shock across the myocardium, typically with a voltage gradient of at least 5V/cm [<xref ref-type="bibr" rid="pone.0158239.ref001">1</xref>]. Patients who survive an initial cardiac arrest are at a higher risk for subsequent cardiac arrests and often require implantable cardioverter defibrillators (ICDs) in order to improve long term survival rates [<xref ref-type="bibr" rid="pone.0158239.ref002">2</xref>, <xref ref-type="bibr" rid="pone.0158239.ref003">3</xref>]. This chronic treatment is not without side effects, however, as defibrillating shocks from ICDs cause intense pain, which puts patients at a severe risk of secondary effects including depression and anxiety [<xref ref-type="bibr" rid="pone.0158239.ref004">4</xref>–<xref ref-type="bibr" rid="pone.0158239.ref007">7</xref>], adversely affecting their quality of life. Furthermore, these shocks can lead to long term damage, including fibrosis [<xref ref-type="bibr" rid="pone.0158239.ref008">8</xref>], as well as other short-term side-effects [<xref ref-type="bibr" rid="pone.0158239.ref009">9</xref>]. This has led researchers to search for new, low-energy defibrillating stimuli in order to reduce pain and other side effects associated with these defibrillating shocks. While researchers have investigated possibilities such as optimizing stimulus waveforms [<xref ref-type="bibr" rid="pone.0158239.ref010">10</xref>] or determining shocks of minimum intensity to achieve defibrillation [<xref ref-type="bibr" rid="pone.0158239.ref011">11</xref>], neither of these strategies yield stimuli which can defibrillate painlessly. Others have developed pacing strategies which can terminate single spiral waves responsible for tachycardia [<xref ref-type="bibr" rid="pone.0158239.ref012">12</xref>] [<xref ref-type="bibr" rid="pone.0158239.ref013">13</xref>], but these strategies are not effective when multiple spirals are present, as is the case during cardiac arrest.</p>
<p>Recently, a new class of defibrillation strategies has emerged [<xref ref-type="bibr" rid="pone.0158239.ref014">14</xref>–<xref ref-type="bibr" rid="pone.0158239.ref017">17</xref>], which attempts to eliminate spiral waves responsible for cardiac fibrillation with a series of low energy electric shocks. It has been shown that in the presence of an electric field, anisotropy in conductivity between cardiac myocites can result in local depolarization or hyperpolarization of the cells [<xref ref-type="bibr" rid="pone.0158239.ref018">18</xref>–<xref ref-type="bibr" rid="pone.0158239.ref020">20</xref>]. This anisotropy in the tissue can be caused by fiber curvature, [<xref ref-type="bibr" rid="pone.0158239.ref021">21</xref>], gap junction discontinuities, [<xref ref-type="bibr" rid="pone.0158239.ref022">22</xref>], or the presence of intracellular clefts [<xref ref-type="bibr" rid="pone.0158239.ref023">23</xref>] such as blood vessels or fatty tissue. If the local depolarization becomes large enough, this tissue anisotropy can create “virtual electrodes” or “secondary sources” from which spreading waves of depolarization can emanate. It has been proposed that these virtual electrodes are responsible for progressively synchronizing the myocardial tissue over the course of multiple shocks, at which point fibrillation is eliminated. It was shown in [<xref ref-type="bibr" rid="pone.0158239.ref014">14</xref>] that as long as the shock frequency is higher than the dominant frequency of spiral wave oscillations, the virtual electrodes will be able to perturb the spiral wave filament, and synchronize the surrounding tissue. However, no framework currently exists for optimizing the pulse timing.</p>
<p>It has been suggested that synchronization of myocardial activity is important for preventing reentry of spiral waves after a defibrillating shock [<xref ref-type="bibr" rid="pone.0158239.ref024">24</xref>–<xref ref-type="bibr" rid="pone.0158239.ref026">26</xref>], and in this work, we propose a methodology for experimentally determining an efficacious sequence of pulses to synchronize the activity of the myocardial cells, increasing the likelihood of eliminating reentrant spiral waves. This strategy only requires the ability to measure action potential durations (APDs) and Diastolic Intervals (DIs) which could be done experimentally. Furthermore, this methodology could readily handle multiple types of stimuli (e.g. strictly hyperpolarizing) if they were available in an experimental setting. Using this newly developed methodology, we are able to determine pulsing patterns which defibrillate at lower energies than pulsing patterns with a fixed frequency.</p>
</sec>
<sec id="sec002">
<title>Bidomain Equation Simulation</title>
<p>We consider a bidomain model for cardiac simulations. The governing equations for the intracellular (<italic>V</italic><sub><italic>i</italic></sub>) and extracellular (<italic>V</italic><sub><italic>e</italic></sub>) potential are [<xref ref-type="bibr" rid="pone.0158239.ref027">27</xref>, <xref ref-type="bibr" rid="pone.0158239.ref028">28</xref>]
<disp-formula id="pone.0158239.e001"><alternatives><graphic id="pone.0158239.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>β</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>e</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>β</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>I</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mtext>ion</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mtext>stim</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>V</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
Here, <inline-formula id="pone.0158239.e002"><alternatives><graphic id="pone.0158239.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0158239.e003"><alternatives><graphic id="pone.0158239.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>e</mml:mi></mml:msub></mml:math></alternatives></inline-formula> intra- and extracellular conductivity tensors, respectively, <italic>β</italic> is the surface to volume ratio of the membrane, <italic>C</italic><sub><italic>m</italic></sub> gives the cell capacitance, <italic>V</italic><sub><italic>m</italic></sub> is the transmembrane voltage, and <italic>I</italic><sub>stim</sub> represents an external current density, which might come from an external pacemaker. <italic>I</italic><sub>ion</sub> gives the cell’s ionic current density, which is determined from the individual cell dynamics. To make the following analysis more concrete, we begin by using the Karma model for cardiac activity [<xref ref-type="bibr" rid="pone.0158239.ref029">29</xref>]:
<disp-formula id="pone.0158239.e004"><alternatives><graphic id="pone.0158239.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mtext>ion</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>n</italic> represents a gating variable. For an explanation of all constants and functions, we refer the reader to [<xref ref-type="bibr" rid="pone.0158239.ref029">29</xref>], with parameters Re = 1.34 and <italic>M</italic> = 4 chosen so that spiral wave breakup is observed in tissue. In bidomain simulations, we take the intracellular and extracellular domain to be a square. An extracardiac space extends past the cardiac tissue on the sides which are transverse to the principal fiber direction (on the left and right sides of the domain in <xref ref-type="fig" rid="pone.0158239.g001">Fig 1</xref>). In these simulations the extracardiac space represents two percent of the overall domain. The extracardiac potential, <italic>V</italic><sub><italic>o</italic></sub>, obeys <inline-formula id="pone.0158239.e005"><alternatives><graphic id="pone.0158239.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>o</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0158239.e006"><alternatives><graphic id="pone.0158239.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>o</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the extracardiac conductivity tensor. Along the boundary of the cardiac tissue and the extracardiac space, the following conditions hold
<disp-formula id="pone.0158239.e007"><alternatives><graphic id="pone.0158239.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:mi>η</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>V</mml:mi> <mml:mi>e</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>o</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>e</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>e</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:mi>η</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>o</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>o</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:mi>η</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
Here, <italic>η</italic> represents a vector normal to the boundary. We assume that an electrode mandates the value of <italic>V</italic><sub><italic>o</italic></sub> on the sides of the extracardiac space transverse to the principal fiber direction. On the remaining boundaries of the domain, we impose no flux boundary conditions. In realistic hearts, the conductivity is anisotropic, and in these two-dimensional simulations we take
<disp-formula id="pone.0158239.e008"><alternatives><graphic id="pone.0158239.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>e</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>o</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
Furthermore, in these simulations, we model the insulating plaque [<xref ref-type="bibr" rid="pone.0158239.ref030">30</xref>–<xref ref-type="bibr" rid="pone.0158239.ref032">32</xref>] that can form in older hearts, by setting <italic>g</italic><sub><italic>ix</italic></sub> = 0 in some areas (which represents the removal groups of gap junctions that are perpendicular to the principal fiber direction (c.f. [<xref ref-type="bibr" rid="pone.0158239.ref014">14</xref>, <xref ref-type="bibr" rid="pone.0158239.ref016">16</xref>]).</p>
<fig id="pone.0158239.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The top panels show an example of randomly chosen sets of gap junctions removed in <xref ref-type="disp-formula" rid="pone.0158239.e001">Eq (1)</xref>, shown in black.</title>
<p>In the bottom panels a voltage gradient of 1500 units applied from left to right to a 2D sheet of quiescent cells <xref ref-type="disp-formula" rid="pone.0158239.e004">Eq (2)</xref> for a duration of 1.5 ms. Because of the removal of the gap junctions, virtual electrodes start to form soon after the voltage gradient is applied. By 12 ms, nearly all cells in the domain have been excited. The colorbar presented here applies to all simulations using the Karma model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g001" xlink:type="simple"/>
</fig>
<p>Defibrillating pulses are modeled by applying an external voltage gradient from left to right in the bottom panels of <xref ref-type="fig" rid="pone.0158239.g001">Fig 1</xref>, transverse to the principal fiber direction. The effect of defibrillating shocks will produce a complicated pattern of depolarization and hyperpolarization near the virtual electrodes, but the main effect of the virtual electrodes is to produce wavefronts of excitation in quiescent cells which quickly excite surrounding quiescent tissue. For this reason, for the remainder of this manuscript, we will refer to this type of stimulation as an excitatory pulse. In order to formulate a computationally tractable control objective, we will approximate each virtual electrode as a point source of excitation for refractory tissue, i.e. we assume that the effects induced by small perturbations to each cell caused by the virtual electrodes (c.f. [<xref ref-type="bibr" rid="pone.0158239.ref033">33</xref>]) are negligable so that they only provide a means of eliciting action potentials. Also, we assume that during a defibrillating pulse, the virtual electrodes will depolarize tissue in an all-or-nothing fashion, meaning that increasing or decreasing the applied voltage can only serve to increase or decrease the size and overall number of virtual electrodes, respectively, based on the distribution of size and shape of conductivity discontinuities present in the myocardial tissue.</p>
</sec>
<sec id="sec003">
<title>Dynamic Programming to Determine a Pulsing Pattern</title>
<p>We initiate a spiral wave in the medium and as time progresses, the initial spiral breaks into multiple spirals. The left panel of <xref ref-type="fig" rid="pone.0158239.g002">Fig 2</xref> shows multiple spiral waves within the medium, and the right panel shows the states of some of the individual cells, evenly distributed throughout the medium. We find that during defibrillation, most cells remain close to a transient attractor [<xref ref-type="bibr" rid="pone.0158239.ref034">34</xref>, <xref ref-type="bibr" rid="pone.0158239.ref035">35</xref>], which in this example is a one-dimensional manifold which the cells tend to follow on their approach to the fixed point. Each cell follows the transient attractor towards the fixed point until it is reexcited by the next wave front.</p>
<fig id="pone.0158239.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The left panel shows the medium with many spiral wave cores present.</title>
<p>The right panel shows the states of 250 cells, chosen to provide a uniform sampling over the grid.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g002" xlink:type="simple"/>
</fig>
<p>Similar to the work in [<xref ref-type="bibr" rid="pone.0158239.ref036">36</xref>], our goal is to synchronize the activity of the cells within the myocardium in order to terminate spiral activity, however here we use a different method. We will assume that the defibrillating stimulus acts on a time scale much shorter than the natural period of the spiral waves so that cells are predominantly reexcited either directly by the virtual electrodes or by the wave fronts created by the virtual electrodes, (see <xref ref-type="fig" rid="pone.0158239.g001">Fig 1</xref>), but that very few cells will be excited by reentrant spiral waves. We formulate a dynamic programming problem to synchronize the activity of <italic>N</italic> uncoupled cells,
<disp-formula id="pone.0158239.e009"><alternatives><graphic id="pone.0158239.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
for <italic>k</italic> = 1, 2, …, <italic>N</italic>. Here, <xref ref-type="disp-formula" rid="pone.0158239.e009">Eq (5)</xref> represents an ODE approximation of multiple uncoupled cells from <xref ref-type="disp-formula" rid="pone.0158239.e001">Eq (1)</xref> with <italic>u</italic>(<italic>t</italic>) being a control input applied identically to each cell and <italic>V</italic><sub><italic>k</italic></sub> and <italic>n</italic><sub><italic>k</italic></sub> being the transmembrane and gating variables, respectively, of cell <italic>k</italic>. To make this problem more amenable to numerical computation, we first notice that during spiral activity, cells quickly converge to the transient attractor in the absence of any external perturbation. In the absence of external stimulation, this allows us to reduce the dimensionality for each cell to one, with each cell obeying
<disp-formula id="pone.0158239.e010"><alternatives><graphic id="pone.0158239.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
for <italic>k</italic> = 1, 2, …, <italic>N</italic>, where <italic>ψ</italic> represents the cell’s position along the transient attractor, with <italic>ψ</italic> = 0 chosen as a convenient reference point. <xref ref-type="disp-formula" rid="pone.0158239.e010">Eq (6)</xref> allows us to understand complicated and potentially high-dimensional dynamics for each cell in terms of a single variable. This strategy has been used extensively in control applications for systems with periodic orbits [<xref ref-type="bibr" rid="pone.0158239.ref037">37</xref>–<xref ref-type="bibr" rid="pone.0158239.ref040">40</xref>], and more recently for excitable systems [<xref ref-type="bibr" rid="pone.0158239.ref033">33</xref>]. We discretize these equations by defining Δ<italic>t</italic> to be the time step and choose <italic>M</italic> points, equally spaced in time by Δ<italic>t</italic> along the transient attractor to adequately cover the initial distribution from the right panel of <xref ref-type="fig" rid="pone.0158239.g002">Fig 2</xref>, yielding a control space <italic>ψ</italic><sup><italic>d</italic></sup> = {0, Δ<italic>t</italic>, 2Δ<italic>t</italic>, …, (<italic>M</italic> − 1)Δ<italic>t</italic>}. Note that <italic>ψ</italic> gives a measurement of how long it will take for the cell to reach position 0 in the absence of any perturbation from diffusive coupling or external stimulus. The possible control values are represented as <inline-formula id="pone.0158239.e011"><alternatives><graphic id="pone.0158239.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msup><mml:mi mathvariant="script">U</mml:mi> <mml:mi>d</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mi>W</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We define a discrete state space <inline-formula id="pone.0158239.e012"><alternatives><graphic id="pone.0158239.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msup><mml:mi mathvariant="script">X</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:math></alternatives></inline-formula> such that it contains a state variable for every possible cell (<italic>ψ</italic><sub>1</sub>, <italic>ψ</italic><sub>2</sub>, …, <italic>ψ</italic><sub><italic>N</italic></sub>). It is typical for the size of a dynamic programming problem to grow exponentially with the number of states, and this application is no exception. For instance, in this problem, if we allow <italic>N</italic> cells to occupy any of the <italic>M</italic> locations along the transient attractor, <inline-formula id="pone.0158239.e013"><alternatives><graphic id="pone.0158239.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msup><mml:mi mathvariant="script">X</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:math></alternatives></inline-formula> would contain <italic>M</italic><sup><italic>N</italic></sup> unique states, each of which would need to be accounted for on each dynamic programming step. Fortunately because the cells are identical and uncoupled, we can eliminate redundant states by assuming
<disp-formula id="pone.0158239.e014"><alternatives><graphic id="pone.0158239.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>≥</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>≥</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>≥</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
The number of possible combinations that need to be considered is equivalent to finding the number of <italic>M</italic>-tuples of non-negtive integers which sum to <italic>N</italic>, which is equivalent to finding the number of weak compositions of <italic>N</italic> with <italic>M</italic> terms. From [<xref ref-type="bibr" rid="pone.0158239.ref041">41</xref>], this reduces the number of states, <italic>S</italic> in the problem to
<disp-formula id="pone.0158239.e015"><alternatives><graphic id="pone.0158239.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>!</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>!</mml:mo> <mml:mspace width="0.277778em"/><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo> <mml:mo>!</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<p>Using <xref ref-type="disp-formula" rid="pone.0158239.e009">Eq (5)</xref>, we can formulate the difference equation:
<disp-formula id="pone.0158239.e016"><alternatives><graphic id="pone.0158239.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1.em"/><mml:mo>∀</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <inline-formula id="pone.0158239.e017"><alternatives><graphic id="pone.0158239.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">X</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the state of the <italic>N</italic> dimensional, discretized system at time <italic>k</italic>. <inline-formula id="pone.0158239.e018"><alternatives><graphic id="pone.0158239.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">U</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the control input at time <italic>k</italic>, <italic>F</italic>(⋅, ⋅) represents the map between states for a given control, and <italic>K</italic> is the end time. We define <italic>u</italic><sub><italic>k</italic></sub> = 0 to represent the possibility of not giving any external control. From <xref ref-type="disp-formula" rid="pone.0158239.e010">Eq (6)</xref>, (<italic>ψ</italic><sub>1</sub> − Δ<italic>t</italic>, <italic>ψ</italic><sub>2</sub> − Δ<italic>t</italic>, …, <italic>ψ</italic><sub><italic>N</italic></sub> − Δ<italic>t</italic>) = <italic>F</italic>((<italic>ψ</italic><sub>1</sub>, <italic>ψ</italic><sub>2</sub>, …, <italic>ψ</italic><sub><italic>N</italic></sub>), 0). If we let <italic>u</italic><sub><italic>k</italic></sub> = 1 represent a defibrillating pulse, then in order to determine <italic>F</italic>(<italic>x</italic><sub><italic>k</italic></sub>, 1), we simulate a single cell from <xref ref-type="disp-formula" rid="pone.0158239.e009">Eq (5)</xref> by applying an excitatory stimulus <italic>u</italic>(<italic>t</italic>) = 2 for 10 ms, and measure the resulting action potential duration. This protocol yields a cellular excitation map, <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic></sub> → <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic>+1</sub>, with <italic>i</italic> representing the cell index and <italic>k</italic> representing the discretized time point, shown in step 2 of <xref ref-type="fig" rid="pone.0158239.g003">Fig 3</xref> with <italic>M</italic> = 36 with states indexed clockwise. Note that different choices of <italic>u</italic>(<italic>t</italic>) will produce a similar excitation map provided they are strong enough to produce an action potential. Here, we have chosen <italic>ψ</italic> = 0 to correspond to a cell which has been repolarized for 120 ms. We define repolarization to occur when the variable <italic>V</italic> comes within 95 percent of its resting value (i.e. <italic>V</italic> = <italic>V</italic><sub>max</sub> − .95(<italic>V</italic><sub>max</sub> − <italic>V</italic><sub>rest</sub>) where <italic>V</italic><sub>max</sub> and <italic>V</italic><sub>rest</sub> represent the maximum and resting potentials of the cell, respectively) and choose Δ<italic>t</italic> = 9.7 ms to achieve an adequate discretization. The excitation map can be interpreted as follows: for a cell at <italic>ψ</italic> = 87, an excitatory stimulus will bring the cell to position <italic>ψ</italic> = 231 after time Δ<italic>t</italic> has elapsed. <italic>F</italic>(<italic>x</italic><sub><italic>k</italic></sub>, 1) is calculated by applying the map to each cell, and <italic>x</italic><sub><italic>k</italic></sub> is reordered to satisfy <xref ref-type="disp-formula" rid="pone.0158239.e014">Eq (7)</xref> if necessary.</p>
<fig id="pone.0158239.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Calculation of optimal pulsing patterns can be obtained in three steps.</title>
<p>First, the transient attractor is discretized into points that are equally spaced in time. In the top panel, the cell repolarizes at <italic>ψ</italic> = 136 which corresponds to a DI of zero (i.e. the state at which cell has just repolarized). A mapping based on giving an excitatory stimulus, <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic></sub> → <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic>+1</sub>, can be calculated using the equations in step 2. From the numerically determined map using the Karma model, we find that if a cell has been recently reexcited, another stimulus does not affect the time at which the cell repolarizes (i.e. <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic>+1</sub> = <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic></sub> − Δ<italic>t</italic>). In steps 1 and 2, we highlight the information required to calculate the excitation map with circled datapoints. Finally, using the excitation map, the dynamic programming procedure outlined here can be be used to calculate an optimal pulsing pattern. Note that multiple maps for different stimuli can be calculated and included in the optimization procedure.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g003" xlink:type="simple"/>
</fig>
<p>We seek to find a sequence of <italic>u</italic><sub><italic>k</italic></sub> which will progressively synchronize the activity of <italic>N</italic> cells along the discretized transient attractor, thereby eliminating spiral wave activity within the myocardium, using the fewest possible number of pulses. We define the time additive cost function:
<disp-formula id="pone.0158239.e019"><alternatives><graphic id="pone.0158239.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>E</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <italic>β</italic><sub><italic>p</italic></sub> &gt; 0 is a penalizing scalar and <italic>E</italic><sub><italic>k</italic></sub> is the energy cost associated with the input <italic>u</italic><sub><italic>k</italic></sub>. Furthermore, <italic>R</italic>(⋅) is chosen to be the standard deviation,
<disp-formula id="pone.0158239.e020"><alternatives><graphic id="pone.0158239.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover><mml:mi>ψ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where <italic>ψ</italic><sub><italic>i</italic>,<italic>K</italic>+1</sub> are the states associated with state <italic>x</italic><sub><italic>K</italic>+1</sub>, and <inline-formula id="pone.0158239.e021"><alternatives><graphic id="pone.0158239.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover><mml:mi>ψ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the mean of those states; this is a measure of how synchronized the system is, with lower values corresponding to greater synchrony. Our goal is to find a sequence <inline-formula id="pone.0158239.e022"><alternatives><graphic id="pone.0158239.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">U</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for <italic>k</italic> = {1, 2, …, <italic>K</italic>} such that <xref ref-type="disp-formula" rid="pone.0158239.e019">Eq (10)</xref> is minimized subject to <xref ref-type="disp-formula" rid="pone.0158239.e016">Eq (9)</xref>.</p>
<p>Following [<xref ref-type="bibr" rid="pone.0158239.ref042">42</xref>], we cast the problem in the dynamic programming format by first defining the cost-to-go function (sometimes referred to as the value function) from a state <italic>x</italic> at time <italic>K</italic> − <italic>q</italic>, denoted <inline-formula id="pone.0158239.e023"><alternatives><graphic id="pone.0158239.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pone.0158239.e024"><alternatives><graphic id="pone.0158239.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">inf</mml:mo> <mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">U</mml:mi> <mml:mi>d</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:mo>∀</mml:mo> <mml:mi>k</mml:mi> <mml:mo>≥</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:munder> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>E</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
According to the principle of optimality [<xref ref-type="bibr" rid="pone.0158239.ref043">43</xref>],
<disp-formula id="pone.0158239.e025"><alternatives><graphic id="pone.0158239.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:munder> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:mi>q</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula> <xref ref-type="disp-formula" rid="pone.0158239.e025">Eq (13)</xref> is a recurrence relation that allows us to iteratively calculate the cost-to-go function, starting with the end point cost, <italic>R</italic>(<italic>x</italic><sub><italic>K</italic>+1</sub>), and working backwards. Once the cost-to-go function is obtained, the optimal control and trajectory are
<disp-formula id="pone.0158239.e026"><alternatives><graphic id="pone.0158239.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mtext>arg</mml:mtext> <mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">U</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula> <disp-formula id="pone.0158239.e027"><alternatives><graphic id="pone.0158239.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
for <italic>k</italic> ∈ {1, 2, …, <italic>K</italic>} starting from an initial state <italic>x</italic><sub>1</sub>. The steps involved in the formulation and calculation of an optimal series of pulses are summarized in <xref ref-type="fig" rid="pone.0158239.g003">Fig 3</xref>.</p>
<p>In the dynamic programming algorithm, a larger (resp. smaller) choice of <italic>E</italic><sub><italic>k</italic></sub> relative to <italic>β</italic><sub><italic>p</italic></sub> will yield an answer with fewer (resp. more) pulses. For the Karma model, we choose <italic>β</italic><sub><italic>p</italic></sub> = 1.5, and choose 2.4 to be the cost of giving an excitatory pulse. We note that in this application, we only have two options: giving an excitatory pulse or not giving a pulse. We choose an end time of <italic>K</italic> = 30 corresponding to <italic>t</italic> = <italic>K</italic>Δ<italic>t</italic> = 291 ms. Ideally we would like to include as many cells as possible in the dynamic programming problem, but computational memory considerations limit the number of cells to <italic>N</italic> = 7 while maintaining an adequate discretization. Panel (D) of <xref ref-type="fig" rid="pone.0158239.g004">Fig 4</xref> shows the resulting optimal sequence. Note that while this sequence is optimal, it is not necessarily guaranteed to be unique (i.e. multiple sequences which are all globally optimal could exist). We also note that we do not choose the optimal pulse train to contain five pulses <italic>a priori</italic>, but rather, this results from the parameters chosen in the optimization process. We see that this optimal pulse train begins with pulses that are relatively spread out, and ends with more frequent pulses. Panels (A)-(C) show the state of the system at times 0, 100, and 220 ms, respectively. Progressive synchronization of the uncoupled cells is clearly demonstrated, and gives a standard deviation <italic>σ</italic> = 2.1 of the times at which cells become repolarized. For comparison, we also simulate trains of 5 pulses with a constant period and the same pulse height as the optimal sequence, with results shown in Panel (E). We find that the optimal sequence synchronizes the cells better than any periodic pulse train as measured by the standard deviation of the times that the cells become quiescent. Because the optimal pulsing sequence takes the APD restitution curve as its primary input, we would expect the optimal pulsing pattern to be sensitive to errors in its measurement. To give a sense of the effect of these errors on the resulting pulsing pattern, we apply the optimization method using APD restitution curves which deviate from the true curve, with examples given in <xref ref-type="fig" rid="pone.0158239.g005">Fig 5</xref>. Each curve is obtained by taking the true APD curve, adding a random number to each data point, and fitting the resulting points to a fourth order polynomial. The resulting pulsing patterns are applied to a population of 36 uncoupled cells with different initial conditions equally spaced in time along the transient attractor. For 37 trials which produce optimal patterns with five pulses, the average standard deviation in repolarization times is 11.1. Compared with the results from <xref ref-type="fig" rid="pone.0158239.g004">Fig 4</xref>, this performance is on par with the best result that can be obtained using fixed interval pulses.</p>
<fig id="pone.0158239.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g004</object-id>
<label>Fig 4</label>
<caption>
<title/>
<p>Panels (A)-(C) show the optimal states of the 7 cell system at times 0, 100, and 220 ms, respectively. Panel (D) shows the optimal pulse train obtained from dynamic programming. In panel (E), we apply five pulses at constant period to the same system of 7 cells (grey line) and a system with one cell at each of the 36 states (black line) along the transient attractor as initial conditions. We see qualitative agreement between both plots. The dashed line represents the standard deviation obtained from optimal pulse train on the 7 cell system.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g004" xlink:type="simple"/>
</fig>
<fig id="pone.0158239.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g005</object-id>
<label>Fig 5</label>
<caption>
<title>The left panel shows the true APD restitution curve for the Karma model in blue.</title>
<p>The optimization process is performed on other randomly generated curves to gauge the robustness of the optimization algorithm. Five representative curves are shown as black lines. The right panel shows the synchronization from resulting optimal stimuli applied to 36 uncoupled cells reported as the standard deviation of their repolarization times.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g005" xlink:type="simple"/>
</fig>
<p>We apply the optimal pulse train to a 2-dimensional bidomain <xref ref-type="disp-formula" rid="pone.0158239.e001">Model (1)</xref> with the ionic currents defined for each cell according to the Karma <xref ref-type="disp-formula" rid="pone.0158239.e009">Model (5)</xref>. We take a relatively large square grid with side length 50.5 cm so that it can support a large number of spiral waves. The period of each spiral wave is approximately 150 to 170 ms, depending on its interaction with the conductivity discontinuities. We compare the optimal strategy to a single pulse strategy, in addition to a fixed-time pulsed strategy with a period of 40, 60, and 200 ms and a single pulse strategy. The duration of all pulses was 10 ms. The 40 ms period was chosen as the best synchronizing rate from panel E of <xref ref-type="fig" rid="pone.0158239.g004">Fig 4</xref>, with the 60 and 200 ms pulsing period chosen for comparison. From panel (E) of <xref ref-type="fig" rid="pone.0158239.g004">Fig 4</xref>, we would expect the series of pulses with 40 ms period to synchronize the tissue more effectively than the series of pules with 60 ms period, resulting in a higher rate of successful defibrillation. For an excitatory stimulus in the bidomain equations, we apply a voltage gradient across the tissue. We take <italic>C</italic><sub><italic>m</italic></sub> = 2<italic>μF</italic>/cm<sup>2</sup>, <italic>β</italic> = 1000cm<sup>−1</sup> and <italic>g</italic><sub><italic>α</italic></sub> to be 0.8, 2, 0.2, 2, 0.8 and 0.2 mS/cm for <italic>α</italic> = <italic>ex</italic>, <italic>ey</italic>, <italic>ix</italic>, <italic>iy</italic>, <italic>ox</italic>, <italic>oy</italic>, respectively These anisotropy ratios are consistent with those reported in [<xref ref-type="bibr" rid="pone.0158239.ref044">44</xref>]. Simulations are performed on a 320 × 320 grid.</p>
<p>For simulations of the Karma model, we randomly remove 650 sets of gap junctions with a maximum, minimum, and average length in the principal fiber direction of 2.8, 0.5, 1.7 percent of the domain, respectively (see the top panel of <xref ref-type="fig" rid="pone.0158239.g001">Fig 1</xref>). Bidomain simulations of <xref ref-type="disp-formula" rid="pone.0158239.e001">Eq (1)</xref> were performed using a fully explicit forward Euler scheme (described by Eqs (14) and (15) of [<xref ref-type="bibr" rid="pone.0158239.ref045">45</xref>]). Linear systems from the resulting discretization were solved with a generalized minimal residual algorithm using the CUSP package [<xref ref-type="bibr" rid="pone.0158239.ref046">46</xref>]. For each trial, the system is simulated long enough so that initial transients due to the initiation of the spiral waves die out, and we categorize the defibrillation as successful if all spiral waves are eliminated by the excitatory pulses. Each trial uses different initial conditions with a different random set of gap junctions removed. Results are plotted in <xref ref-type="fig" rid="pone.0158239.g006">Fig 6</xref>, with error bars corresponding to one standard deviation calculated from a Wilson score interval with at least <italic>n</italic> = 23 trials for each data point. For the multiple pulse strategies, shock strengths are reported as the maximum difference in extracellular voltage over the entire 2D domain during an excitatory pulse. For the single defibrillating pulse, the shock strength is chosen so that the energy consumption is identical to the multiple pulse strategies, assuming that energy consumption of each shock is proportional to ∫ (Shock Strength)<sup>2</sup> <italic>dt</italic>. We find that the optimal strategy outperforms the single, 60 ms, and 200 ms period strategies at all shock strengths, and is better than the 40 ms period strategy at low energies. We note that while the success rate of 40 ms period pulsing strategy was similar to the optimal strategy, we were only able to determine that a 40 ms pulsing period worked well for synchronizing the cells through trial and error (see <xref ref-type="fig" rid="pone.0158239.g004">Fig 4</xref>). This trial and error approach is simple <italic>in silico</italic>, but may be much more difficult in real tissue. Conversely, the calculation of an optimal stimulus only requires a few measurements to determine the excitation map <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic></sub> → <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic>+1</sub>.</p>
<fig id="pone.0158239.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Comparison of the success rate for various defibrillation strategies.</title>
<p>Error bars represent a confidence interval corresponding to one standard deviation. Overall, the synchronization predicted from panel E of <xref ref-type="fig" rid="pone.0158239.g004">Fig 4</xref> is correlated to the success rate for each shock strategy. For all multiple pulse trials, the shock strength is reported as the difference between the maximum and minimum extracellular voltages. For the single defibrillating pulse, the induced voltage gradient is <inline-formula id="pone.0158239.e028"><alternatives><graphic id="pone.0158239.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msqrt><mml:mn>5</mml:mn></mml:msqrt> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtext>Shock</mml:mtext> <mml:mspace width="0.277778em"/><mml:mtext>Strength</mml:mtext></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to keep energy consumption equivalent to that of the other trials, assuming energy consumption is proportional to ∫ (Shock Strength)<sup>2</sup> <italic>dt</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g006" xlink:type="simple"/>
</fig>
<p>Our original hypothesis was that increased synchronization would make spiral wave reentry less likely. For this particular model however, regardless of the pulsing pattern, excitatory shocks produce a similar pattern of depolarization and hyperpolarization throughout the medium due to the virtual electrodes. For this reason, a metric that only examines synchronization has similar features regardless of the pulsing pattern used. Instead, for this model we choose a measurement of how well the excited and quiescent tissue is mixed throughout the tissue. If the excited and quiescent tissue is well mixed after the final pulse, then the series of pulses was successful at synchronizing a large majority of tissue, and the pattern in the 2D medium is primarily due to locations at which the influence of the virtual electrodes was particularly strong. Conversely, if regions which were similar in location along the transient attractor before the pulses started are still similar after the final pulse, then the excited and quiescent tissue will not be well mixed, making spiral reentry more likely (see <xref ref-type="fig" rid="pone.0158239.g007">Fig 7</xref> for illustration). Therefore, to give a sense of the spatial heterogeneity in the tissue we track the index of dissimilarity [<xref ref-type="bibr" rid="pone.0158239.ref047">47</xref>] (ID) throughout the tissue:
<disp-formula id="pone.0158239.e029"><alternatives><graphic id="pone.0158239.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>ID</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mo>|</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>e</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>q</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>Q</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>|</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
To calculate <xref ref-type="disp-formula" rid="pone.0158239.e029">Eq (16)</xref>, the 2-dimensional tissue, which is on a 320 × 320 grid, is divided into <italic>N</italic> = 16<sup>2</sup>, 20 × 20 bins, where <italic>e</italic><sub><italic>j</italic></sub>(<italic>t</italic>) and <italic>q</italic><sub><italic>j</italic></sub>(<italic>t</italic>) represent the number of excited and quiescent cells in region <italic>j</italic>, respectively, and <italic>E</italic>(<italic>t</italic>) and <italic>Q</italic>(<italic>t</italic>) represent the total number of excited cells and quiescent cells at time <italic>t</italic>. Cells are categorized as excited if <italic>V</italic><sub><italic>m</italic></sub> &gt; 1, and deemed quiescent otherwise. The ID can be understood intuitively as the proportion of excited cells which would need to be redistributed so that the distribution in each bin matches the global distribution; a small value of ID means that the quiescent and excited cells are well mixed throughout the tissue. <xref ref-type="fig" rid="pone.0158239.g008">Fig 8</xref> shows the ID plotted over multiple trials using each strategy when the shock strength is 50 percent of the maximum. Horizontal dotted lines represented the average value of ID 30 ms after the final pulse has been applied. We find that before pulses are applied ID is close to 0.8 when spiral waves are present in the medium. While ID drops suddenly during each pulse because of the pattern of hyperpolarization and depolarization that occurs at each discontinuity, it is important to consider the value that the ID rebounds to as a measure of the dissimilarity throughout the tissue. On average, the ID 30 ms after the final pulse has been applied is significantly lower for the optimal stimulus than it is for the 40 or 60 ms pulsed strategies. Intuitively, a more heterogeneous distribution of quiescent and excited tissue, makes it is less likely that spirals will be able to find a pathway to reenter the tissue after the pulses are finished.</p>
<fig id="pone.0158239.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g007</object-id>
<label>Fig 7</label>
<caption>
<title>For the Karma model, the ID metric given in <xref ref-type="disp-formula" rid="pone.0158239.e029">Eq (16)</xref> gives a sense of the spatial synchronization in the tissue.</title>
<p>In the top panels, using the optimal stimulus yields an ID of 0.46 40 ms after the final pulse is applied. The distribution of excited and quiescent cells is similar throughout the tissue, making it less likely that the remaining wave fronts will find a reentrant pathway. In the bottom panel, using the 60 ms pulsed stimulus yields an ID of 0.62 40 ms after the final pulse is applied. The large connected regions of excited and quiescent tissue make it more likely that the remaining wave fronts will produce new reentrant waves.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g007" xlink:type="simple"/>
</fig>
<fig id="pone.0158239.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g008</object-id>
<label>Fig 8</label>
<caption>
<title>The top, middle, and bottom panels show representative plots of the ID as a function of time over multiple trials using the 60 ms pulsed, 40 ms pulsed, and optimal pulsing strategies, respectively.</title>
<p>During each pulse, the ID drops suddenly, because of the pattern of hyperpolarization and depolarization that the virtual electrodes create. If the ID soon after the final pulse is small, it indicates that excited and quiescent tissue are thoroughly mixed, making it less likely for spirals to reenter. Over multiple trials, the average value of ID 30 ms after the final pulse is 0.456, 0.539, and 0.668 for the optimal, 40 ms pulsed, and 60 ms pulsed strategies, respectively, as indicated by dotted lines in each figure. These results are consistent with the synchronization that would be expected from panel (E) of <xref ref-type="fig" rid="pone.0158239.g004">Fig 4</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g008" xlink:type="simple"/>
</fig>
<p>Figs <xref ref-type="fig" rid="pone.0158239.g009">9</xref> (see also <xref ref-type="supplementary-material" rid="pone.0158239.s002">S2 File</xref>) and <xref ref-type="fig" rid="pone.0158239.g010">10</xref> (see also <xref ref-type="supplementary-material" rid="pone.0158239.s003">S3 File</xref>) show defibrillation attempts for the optimal and 60 ms period pulsed strategies at 50 percent of the maximum shock strength. The panel at <italic>t</italic> = 0 in each figure shows the system before any defibrillating pulses are applied. The next five panels show the system approximately 30 ms after each pulse is applied. Note that after the final pulse at <italic>t</italic> = 291ms in <xref ref-type="fig" rid="pone.0158239.g009">Fig 9</xref> (corresponding to the optimal pulse train), any remaining excited cells are spread evenly throughout the medium, while after the final pulse at <italic>t</italic> = 339ms in <xref ref-type="fig" rid="pone.0158239.g010">Fig 10</xref>, large regions in the domain remain depolarized, while other regions are quiescent. This spatial heterogeneity is conducive to spiral reentry, as can be seen in the final two snapshots of <xref ref-type="fig" rid="pone.0158239.g010">Fig 10</xref>. The final two snapshots in <xref ref-type="fig" rid="pone.0158239.g009">Fig 9</xref> show that activation fronts quickly depolarize most of the cells in the medium, terminating any remaining spiral waves.</p>
<fig id="pone.0158239.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Successful defibrillation using a 5-pulse optimal strategy.</title>
<p>The panel at <italic>t</italic> = 0ms shows the system before a defibrillating stimulus is applied. The next five panels show the system approximately 30ms after successive pulses are applied. Notice that soon after the last pulse is applied at <italic>t</italic> = 291ms, the ID is close to 0.45, indicating that the excited and quiescent cells are spread evenly throughout the medium. In the final two panels, any remaining spiral waves are extinguished. The bottom panel shows ID as a function of time. See also <xref ref-type="supplementary-material" rid="pone.0158239.s002">S2 File</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g009" xlink:type="simple"/>
</fig>
<fig id="pone.0158239.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Unsuccessful defibrillation using five pulses, applied 60 ms apart.</title>
<p>The panel at <italic>t</italic> = 0ms shows the system before a defibrillating stimulus is applied. The next five panels show the system approximately 30ms after successive pulses are applied. Notice that soon after the last pulse is applied at <italic>t</italic> = 339ms, the ID is around 0.65, indicating that there will likely be pathways for spiral waves to reenter, as shown in the final two panels. See also <xref ref-type="supplementary-material" rid="pone.0158239.s003">S3 File</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g010" xlink:type="simple"/>
</fig>
<p>Finally, we briefly discuss the feasibility of using biphasic defibrillation [<xref ref-type="bibr" rid="pone.0158239.ref048">48</xref>, <xref ref-type="bibr" rid="pone.0158239.ref049">49</xref>] strategies, which use secondary shocks to reverse the flow of current caused by the first shock. Biphasic shocks have been shown to require less energy to defibrillate than monophasic shocks. The preceding optimization calculations were performed with the assumption that each defibrillating pulse creates virtual electrodes that depolarize tissue in an all-or-nothing fashion. We will assume that a secondary pulse with opposite sign will not create or remove any virtual electrodes, but will simply remove residual charge that may be left over from the primary pulse [<xref ref-type="bibr" rid="pone.0158239.ref050">50</xref>, <xref ref-type="bibr" rid="pone.0158239.ref051">51</xref>]. With these assumptions, the optimization calculations yield the same optimal pulsing sequence. In pilot simulations, biphasic shocks consisted of a pulse with a shock strength of 4000 (resp. 5500) followed immediately by a pulse with shock strength -2000 (resp. -2750). Here the secondary negative perturbation lasts twice as long as the primary positive perturbation. Using the optimal pulsing pattern yielded a success rate of 86 percent over 21 trials (resp. 100 percent over 29 trials). Using five identical biphasic perturbations spaced 40ms apart yielded a success rate of 50 percent over 20 trials (resp. 76 percent over 29 trials). Compared to the results presented in <xref ref-type="fig" rid="pone.0158239.g006">Fig 6</xref>, these preliminary results suggest that a biphasic waveform might further increase the efficacy of an optimal pulsing pattern. A comprehensive study using biphasic waveforms is beyond the scope of this work.</p>
</sec>
<sec id="sec004">
<title>Control Strategy Applied to the ten Tusscher-Panfilov Model of Cardiac Activity</title>
<p>We now illustrate our control strategy for the ten Tusscher-Panfilov model [<xref ref-type="bibr" rid="pone.0158239.ref052">52</xref>]. This model is based on experimental data for human ventricular cells and includes important intracellular ionic currents. We use the parameter settings from [<xref ref-type="bibr" rid="pone.0158239.ref052">52</xref>] which yield an APD restitution curve with a slope of 1.4 when measured with a single cell, and use a Rush and Larsen [<xref ref-type="bibr" rid="pone.0158239.ref053">53</xref>] integration scheme to integrate the Hodgkin-Huxley type gating variables. In tissue, the spiral period is approximately 230 to 250 ms. We measure the APD restitution curve shown in the top left panel of <xref ref-type="fig" rid="pone.0158239.g011">Fig 11</xref> using an <italic>S</italic>1 − <italic>S</italic>2 pacing protocol with <italic>S</italic>1 = 230 ms: the tissue is paced at 230 ms until the dynamics achieve a steady state, the next pulse is presented at a given DI, and the APD is measured to yield a single data point. In order to pace the tissue, we use direct current stimulation at a point source in the center of the tissue with <italic>I</italic><sub>stim</sub>/<italic>C</italic><sub><italic>m</italic></sub> = 150 <italic>μ</italic>A/<italic>μ</italic>F. The excitation map can be calculated from the resulting APD restitution curve, measured with respect to a location near the edge of the tissue. In this example we let <italic>ψ</italic> ∈ [0, 350], where <italic>ψ</italic> = 0 represents the time 120 ms after the cell repolarized. Repolarization is defined to occur when the transmembrane voltage comes within 95 percent of its resting value (i.e. <italic>V</italic><sub>max</sub> − .95(<italic>V</italic><sub>max</sub> − <italic>V</italic><sub>rest</sub>)), and take Δ<italic>t</italic> = 10. If we excite a cell at <italic>ψ</italic> = 0, the resulting APD will be approximately 240 ms, and 10 ms after the excitation, <italic>ψ</italic> ≈ 350. This process can be repeated for each 10 ms bin, to determine the excitation map, shown in the bottom-left panel of <xref ref-type="fig" rid="pone.0158239.g011">Fig 11</xref>. Note that if <italic>ψ</italic> &gt; 70 (corresponding to DI&lt;50), the cell is not excitable, and <italic>ψ</italic> simply decreases by 10 ms after an attempted excitation. We note that the range of <italic>ψ</italic> and its discretization can be taken slightly differently in the dynamic programming algorithm to yield qualitatively similar results.</p>
<fig id="pone.0158239.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g011</object-id>
<label>Fig 11</label>
<caption>
<title>The top-left panel shows the APD restitution curve DIs, and the bottom-left panel shows the excitation map, which is inferred from the APD restitution curve.</title>
<p>The top-right shows that a strictly hyperpolarizing stimulus applied soon after a cell is excited (<italic>ψ</italic> ≈ 350) has little effect on the time at which the cell repolarizes, while the same stimulus applied later (<italic>ψ</italic> ≈ 230) will hasten repolarization. The dashed line shows the transmembrane voltage if the strictly hyperpolarizing stimulus had not been applied. The bottom-right panel shows the hyperpolarization map, which is calculated for each discretized phase.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g011" xlink:type="simple"/>
</fig>
<p>For this model, as might be expected from the excitation map, we find that it is not possible to design a pulse train of excitatory pulses to synchronize the tissue because there is a very small window in which each cell can be excited. One possibility of mitigating this problem would be to extend the maximum allowable DI, but the resulting optimal pulse trains would contain some pulses which are spaced close to the natural spiral period, invalidating the assumptions of our control algorithm. In this example, in order to illustrate the power of the proposed control methodology and to design a stimulus which can significantly synchronize the cells, as a second stimulus option we include the possibility of giving a strictly hyperpolarizing stimulus through current injection uniformly to each cell. We note that a strictly hyperpolarizing stimulus is not plausible in a clinical setting, and include the possibility of a hyperpolarizing stimulus to showcase the modularity of the proposed control algorithm; including different types of external stimuli can be readily handled by the control methodology and can greatly improve synchronization of the tissue. We also emphasize that the control methodology is not limited to only the stimuli we consider in this manuscript, and could be implemented with another stimulus provided that its effect can be characterized by a map of the form <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic></sub> → <italic>ψ</italic><sub><italic>i</italic>,<italic>k</italic>+1</sub>. With this in mind, we assume that we have the ability to give uniform strictly hyperpolarizing pulses throughout the entirety of the tissue, <italic>I</italic><sub>stim</sub>/<italic>C</italic><sub><italic>m</italic></sub> = −70<italic>μ</italic>A/<italic>μ</italic>F, for 1 millisecond. To measure the hyperpolarization map, one can give the strictly hyperpolarizing stimulus at a known phase, and determine the time at which the cell repolarizes. For instance, when stimulus is applied at <italic>ψ</italic> ≈ 230, the cell repolarizes approximately 30 seconds later. Recall that <italic>ψ</italic> = 120 corresponds to the time a cell repolarizes, therefore <italic>ψ</italic> ≈ 120 + 30 − Δ<italic>t</italic> = 140 ms after the stimulus is applied. The hyperpolarization map can then be used in the optimization.</p>
<p>For the dynamic programming calculations, we choose <italic>β</italic><sub><italic>p</italic></sub> = 0.75, and choose 2.4 to be the cost of giving either an excitatory or strictly hyperpolarizing pulse. We choose an end time of <italic>K</italic> = 40 corresponding to <italic>t</italic> = 400. The resulting optimal control contains three excitatory pulses and one inhibitory pulse. In <xref ref-type="supplementary-material" rid="pone.0158239.s004">S4 File</xref>, we apply this control to a group of 18, 2 dimensional patches of tissue, with initial conditions equally spaced in <italic>ψ</italic>. Here, the patches are not coupled to each other. In these simulations, during an excitatory stimulus, depolarizing current is applied to a small region near the middle of the patch to mimic the wave of spreading depolarization created from a virtual electrode. The resulting transmembrane voltage is shown for a single cell from each patch in the top panel of <xref ref-type="fig" rid="pone.0158239.g012">Fig 12</xref>. We compare this strategy to a 80 ms period (see <xref ref-type="supplementary-material" rid="pone.0158239.s005">S5 File</xref>) and 40 ms period excitatory pulsed strategy, shown in the middle and bottom panels of <xref ref-type="fig" rid="pone.0158239.g012">Fig 12</xref>. Note that for this model, the synchronization in individual cell simulations did not depend strongly on pulsing periods in the range between 30 ms and 100 ms. We find that the optimal strategy greatly outperforms the other strategies in terms of the distribution of times at which the cells repolarized, as represented by the grey boxes.</p>
<fig id="pone.0158239.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g012</object-id>
<label>Fig 12</label>
<caption>
<title>The top, middle, and bottom panels show 18 cells with equal initial spacing in <italic>ψ</italic> with optimal, 80 ms pulsed, and 40 ms pulsed control strategies applied, respectively.</title>
<p>The grey boxes represent the distribution of times at which cells repolarize. In the signals below the voltage traces, positive pulses represent excitatory perturbations. The negative pulse in the top panel occurs at approximately 100 ms and represents a strictly hyperpolarizing perturbation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g012" xlink:type="simple"/>
</fig>
<p>In this optimization, errors in measuring both the effect of the depolarizing and hyperpolarizing pulses will contribute to errors in the resulting optimal pulsing pattern. As in the previous example, we give a sense of the robustness of these calculations by applying the optimization algorithm when the input data is not perfect. Multiple excitation maps were obtained using APD restitution curves which are different from the true restitution curve. Each APD restitution curve curve is obtained starting with the true APD curve, adding a random number to each data point, and fitting the resulting points to a fourth order polynomial. Representative curves used in the optimization procedure are given in the left panel of <xref ref-type="fig" rid="pone.0158239.g013">Fig 13</xref>. Errors are also introduced to the hyperpolarization map for all data points corresponding to times when the cell has not yet repolarized, (i.e. for isostable values greater than 120) by starting with true data points and adding a randomly chosen number drawn from a normal distribution with mean zero and standard deviation 15. The right panel of <xref ref-type="fig" rid="pone.0158239.g013">Fig 13</xref> shows the resulting optimal stimuli over 98 trials. The resulting pulsing patterns are qualitatively similar to the true optimal series of pulsing with slight variations in timing depending on the inputs to the optimization. Occasionally the hyperpolarizing pulse is applied later in the resulting pulse sequence, but is always followed soon after by an excitatory pulse.</p>
<fig id="pone.0158239.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g013</object-id>
<label>Fig 13</label>
<caption>
<title>The left panel shows the true APD restitution curve for the ten Tusscher-Panfilov model in blue.</title>
<p>The optimization is performed using randomly modified APD restitution curves and hyperpolarization maps as described in the text. Five representative APD curves are shown in black. The right panel gives the resulting optimal pulsing pattern calculated over 98 trials. Red marks indicate excitatory pulses and blue marks represent hyperpolarizing pulses. For comparison, the optimal pulse series using the true data has excitatory pulses at 0, 120, and 200 ms and a hyperpolarizing pulse at 100 ms.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g013" xlink:type="simple"/>
</fig>
<p>Finally, we apply the optimal pulsing strategy to the 2-dimensional bidomain <xref ref-type="disp-formula" rid="pone.0158239.e001">Model (1)</xref> on a square domain with side length 4.16 cm. We also compare this strategy to an excitatory fixed pulsed strategy with a 40, 80, and 200 ms period and a single pulse strategy. We also compare to a non-optimal strategy implemented with a strictly hyperpolarizing stimulus followed by three excitatory stimuli at 80 ms intervals. In the bidomain equations, for an excitatory stimulus, we apply a constant voltage gradient across the tissue, and when a strictly hyperpolarizing pulse is applied, <italic>I</italic><sub>stim</sub> = 70<italic>μ</italic>A/cm<sup>2</sup> for each cell. We take <italic>g</italic><sub><italic>α</italic></sub> to be 0.214, 0.375, 0.0375, 0.375, 0.214, and 0.375 S/m for <italic>α</italic> = <italic>ex</italic>, <italic>ey</italic>, <italic>ix</italic>, <italic>iy</italic>, <italic>ox</italic>, <italic>oy</italic>, respectively, [<xref ref-type="bibr" rid="pone.0158239.ref054">54</xref>]. We also take <italic>β</italic> = 1000 cm<sup>−1</sup>. Here, we randomly remove 400 sets of gap junctions with a maximum, minimum, and average length of 2100, 300, and 1200 microns, respectively, oriented along the fiber direction by taking <italic>g</italic><sub><italic>ix</italic></sub> = 0. All other parameters are the same as those given in [<xref ref-type="bibr" rid="pone.0158239.ref052">52</xref>]. Bidomain simulations of <xref ref-type="disp-formula" rid="pone.0158239.e001">Eq (1)</xref> were performed on a 320 × 320 grid using forward Euler with a generalized minimal residual algorithm. For these simulations, the system is simulated long enough so that initial transients due to the initiation of the spiral waves die out and we categorize the defibrillation as successful if all spiral waves are eliminated by the excitatory pulses. Each trial uses different initial conditions with a different random set of gap junctions removed.</p>
<p>Results are plotted in <xref ref-type="fig" rid="pone.0158239.g014">Fig 14</xref>, with error bars corresponding to one standard deviation calculated from a Wilson score interval with at least <italic>n</italic> = 29 trials for each datapoint. In this case, we find that the optimal strategy outperforms each pulsed strategy at all shock strengths, and performs especially well at higher shock strengths. In these simulations, we gauge the level of synchronization by keeping track of the proportion of active cells in the tissue, and show this value over multiple trials of each strategy when the excitatory pulse strength is 2.89 V/cm in <xref ref-type="fig" rid="pone.0158239.g015">Fig 15</xref>. We note that we use a different metric than we did earlier because it is a more natural measurement of the synchronization of the cells, and, unlike in the Karma model, the pattern of hyperpolarization and depolarization caused by the virtual electrodes does not dominate this measurement. Over multiple trials, after the final pulse of the optimal strategy has been applied, an average of 96.8 percent of cells are active, compared to 90.3 and 91.8 percent for the 80 ms and 40 ms pulsed strategies. This increased proportion of activated cells for the optimal stimulus translates into a higher probability that spiral waves will not be able to sustain reentry.</p>
<fig id="pone.0158239.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Numerically observed probability of successful defibrillation of the ten Tusscher-Panfilov Cardiac Model.</title>
<p>Error bars represent a confidence interval corresponding to one standard deviation. For all multiple pulse trials, the shock strength is reported as the voltage gradient induced during an excitatory pulse. For the single defibrillating pulse, the induced voltage gradient is <inline-formula id="pone.0158239.e030"><alternatives><graphic id="pone.0158239.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msqrt><mml:mn>5</mml:mn></mml:msqrt> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtext>Shock</mml:mtext> <mml:mspace width="0.277778em"/><mml:mtext>Strength</mml:mtext></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to keep energy consumption equivalent to that of the strictly excitatory trials, assuming energy consumption is proportional to ∫ (Shock Strength)<sup>2</sup> <italic>dt</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g014" xlink:type="simple"/>
</fig>
<fig id="pone.0158239.g015" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g015</object-id>
<label>Fig 15</label>
<caption>
<title>The top, middle, and bottom panels show representative plots of the proportion of active tissue (transmembrane voltage greater than -70 mV) as a function of time over multiple trials using the 80 ms pulsed, 40 ms pulsed, and optimal strategies respectively with an excitatory pulse strength of 2.89 V/cm.</title>
<p>Dashed lines at 0.968, 0.903, and 0.918 for the optimal, 40 ms pulsed, and 80 ms pulsed strategies, respectively represent the maximum proportion of active cells, averaged over multiple trials.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g015" xlink:type="simple"/>
</fig>
<p>A representative trial using the optimal strategy with excitatory input at 2.89 V/cm is shown in <xref ref-type="fig" rid="pone.0158239.g016">Fig 16</xref> (See also <xref ref-type="supplementary-material" rid="pone.0158239.s007">S7 File</xref>). At <italic>t</italic> = 84ms, the first excitatory shock excites some of the quiescent tissue. At <italic>t</italic> ≈ 184 ms, the strictly hyperpolarizing pulse is applied, and tissue near the wave front is not affected, while tissue which is closer to becoming refractory recovers faster. The final two excitatory shocks are able to excite nearly all of the remaining tissue, so that the spiral waves are eliminated. Note that the colorbar in <xref ref-type="fig" rid="pone.0158239.g016">Fig 16</xref> applies to all simulations of the ten Tusscher-Panfilov model. A representative trial using the 80 ms pulsed strategy at 2.89 V/cm is shown in <xref ref-type="fig" rid="pone.0158239.g017">Fig 17</xref> (see also <xref ref-type="supplementary-material" rid="pone.0158239.s008">S8 File</xref>). Notice that in contrast to the simulation shown in <xref ref-type="fig" rid="pone.0158239.g016">Fig 16</xref>, after the last excitatory pulse at <italic>t</italic> = 408 ms, large portions of tissue remain quiescent, and spiral waves persist in the medium.</p>
<fig id="pone.0158239.g016" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g016</object-id>
<label>Fig 16</label>
<caption>
<title>A representative trial using the optimal strategy with excitatory shocks given with 2.89 V/cm.</title>
<p>The pulsing strategy manipulates the tissue so that soon after the final pulse at <italic>t</italic> = 308ms, most of the cells are excited, and spiral waves cannot continue to propagate through the medium. The bottom panel shows the proportion of active cells as a function of time. The colorbar presented here applies to all simulations using the ten Tusscher-Panfilov model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g016" xlink:type="simple"/>
</fig>
<fig id="pone.0158239.g017" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0158239.g017</object-id>
<label>Fig 17</label>
<caption>
<title>A representative trial using the 80 ms pulsed strategy with shocks at 2.89 V/cm.</title>
<p>Soon after the final pulse at <italic>t</italic> = 408ms, large portions of tissue are still quiescent, allowing spiral waves to persist. The bottom panel shows the proportion of active cells as a function of time.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.g017" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005" sec-type="conclusions">
<title>Discussion and Conclusion</title>
<p>We have proposed a methodology which can be used to find an efficacious series of pulsed inputs to synchronize the activity of myocardial tissue, which increases the likelihood of preventing spiral wave reentry. In a simple two-dimensional model, we were able to design a series of low-voltage excitatory shocks which eliminated reentrant spiral waves with a much higher success rate than a single, high-voltage shock. Furthermore, the resulting optimal pulse sequence was at least as good as a fixed rate pulsing strategy which needed to be found through trial and error (see panel (E) of <xref ref-type="fig" rid="pone.0158239.g004">Fig 4</xref>). Using the more realistic ten Tusscher-Panfilov model, we were also able to design a series of excitatory and inhibitory pulses which greatly synchronized the tissue, and led to a high success rate when compared to other single- or multi-pulse strategies. These results suggest that fixed time pulsatile stimulation as currently implemented by low energy strategies may be far from optimal and that the development of strategies to synchronize cardiac cell activity could offer significant room for improvement.</p>
<p>These results represent a proof of concept that the proposed dynamic programming methodology could be used to determine a series of perturbations to cardiac tissue which promote synchronization and eliminate spiral waves, which are thought to be responsible for fibrillation. This dynamic programming methodology could be feasibly implemented experimentally, because it only requires knowledge of how a particular stimulus affects individual cells at certain phases, which can be found by measuring cell action potential durations using, for example, microelectrode recordings of single cell activity or with optical mapping techniques [<xref ref-type="bibr" rid="pone.0158239.ref055">55</xref>] [<xref ref-type="bibr" rid="pone.0158239.ref056">56</xref>]. Furthermore, including the possibility of more than one type of stimulus can greatly improve the dynamic programming algorithm’s ability to find a series of pulses to synchronize the activity of the myocardial tissue. In this work we have only considered the possibility of excitatory and strictly hyperpolarizing perturbations to the cardiac tissue, but other stimuli could easily be considered by the algorithm, provided that the effect on the cells can be experimentally determined.</p>
<p>With regard to optimality of the resulting pulsing patterns, the optimization process is dependent on the ability to accurately measure restitution curves from a given system, a task which is not trivial in an experimental system. In living cardiac tissue, restitution curves are known to vary over time due to pacing history [<xref ref-type="bibr" rid="pone.0158239.ref057">57</xref>, <xref ref-type="bibr" rid="pone.0158239.ref058">58</xref>]. Furthermore, spatially varying intracellular ion concentrations can result in local variations in the dynamics and a single pulsing pattern may not be optimal in different locations. In this work, we have not fully addressed how errors in the measured restitution curves affect the optimality of the resulting pulsing pattern. Despite these limitations, post-hoc analysis of the resulting optimal stimuli in the computational models can reveal potentially unexpected qualities of useful stimuli for defibrillation in a particular model. For instance, for the Karma model, the optimal stimulus contains two relatively long stimuli followed by a more rapid burst of sequential stimuli. For this model, there is no delay between the time the cell repolarizes and can fire an action potential so that the final burst of stimuli synchronize the cells by trapping their states in a region close to the point that the cells repolarize. This means of synchronization does not exist for the ten Tusscher-Panfilov model, because the cells must be repolarized for a sufficiently long time before they can fire a new action potential. In this case, the dynamic programming algorithm reveals that there is no efficient way to synchronize the cells using only excitatory stimuli. When we include the possibility of a strictly hyperpolarizing stimulus, the dynamic programming algorithm finds that an appropriately timed strictly hyperpolarizing stimulus can prematurely repolarize a large portion of the cells so that successive excitatory stimuli can synchronize the remaining cells (see <xref ref-type="fig" rid="pone.0158239.g012">Fig 12</xref>).</p>
<p>While the results suggest a promising new strategy, they are not without limitations. For instance, we did not test the defibrillation strategy in the presence of larger discontinuities, which may be present in some hearts and would allow spiral waves to be “pinned” in place [<xref ref-type="bibr" rid="pone.0158239.ref059">59</xref>–<xref ref-type="bibr" rid="pone.0158239.ref061">61</xref>]. Furthermore, numerical simulations were performed on a square domain, and did not take the complicated geometry of a real heart into consideration. Also, in this work, we assume that the underlying cell dynamics are homogeneous. If there are different cell types that need to be synchronized, the dynamic programming algorithm could still be implemented by including separate groups with different properties at the expense of increasing the size of the state space <inline-formula id="pone.0158239.e031"><alternatives><graphic id="pone.0158239.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0158239.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mi mathvariant="script">X</mml:mi></mml:math></alternatives></inline-formula>. These issues might need to be considered before performing <italic>in vivo</italic> experiments.</p>
<p>The pulsatile defibrillation strategy proposed in this work was primarily implemented with monophasic shocks with current flowing in a single direction. In a clinical setting, however, defibrillators typically use a biphasic waveform where the second phase of the shock is meant to reverse the flow of current from the first shock. These waveforms have been shown to require significantly less energy to defibrillate than using monophasic shocks [<xref ref-type="bibr" rid="pone.0158239.ref048">48</xref>, <xref ref-type="bibr" rid="pone.0158239.ref049">49</xref>]. While a full analysis of biphasic defibrillation strategies is beyond the scope of this article, pilot simulations of the Karma model suggest that biphasic defibrillation might increase the efficacy of the defibrillating sequence. Using biphasic excitatory stimuli in pilot simulations of the ten Tusscher-Panfilov model did not significantly alter the success rate of defibrillation. Future work could investigate the problem of optimizing defibrillation waveforms [<xref ref-type="bibr" rid="pone.0158239.ref010">10</xref>, <xref ref-type="bibr" rid="pone.0158239.ref062">62</xref>], for use with pulsatile defibrillation strategies.</p>
<p>These results suggest that stimuli which achieve greater spatial synchronization of myocardial activity can greatly increase the success rate of defibrillation, and may suggest strategies for optimizing newer antifibrillation pacing strategies [<xref ref-type="bibr" rid="pone.0158239.ref014">14</xref>–<xref ref-type="bibr" rid="pone.0158239.ref017">17</xref>]. When used in conjunction with other stimuli than an excitatory stimulus from an ICD, the synchronizing strategy suggested in this work could reduce the energy required for successful defibrillation and could potentially mitigate the physiological and psychological side effects associated with frequent defibrillation.</p>
</sec>
<sec id="sec006">
<title>Supporting Information</title>
<supplementary-material id="pone.0158239.s001" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>In this bidomain simulation of the Karma model, a single pulse fails to eliminate spiral waves in the medium.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0158239.s002" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.s002" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>In this bidomain simulation of the Karma model, the optimal series of 5 excitatory pulses eliminates spiral waves in the medium.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0158239.s003" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.s003" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>In this bidomain simulation of the Karma model, the series of 5 excitatory pulses at constant intervals fails to eliminate spiral waves in the medium.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0158239.s004" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.s004" xlink:type="simple">
<label>S4 File</label>
<caption>
<title>The optimal control strategy determined from the dynamic programming strategy is applied to square patches of tissue from the TNNP model.</title>
<p>Each patch is initially equally spaced in <italic>ψ</italic>. The pulsing strategy is effective at synchronizing the activity of the patches.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0158239.s005" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.s005" xlink:type="simple">
<label>S5 File</label>
<caption>
<title>Excitatory pulses are applied to 18 square patches of tissue from the TNNP model.</title>
<p>Each patch is initially equally spaced in <italic>ψ</italic>. The pulsing strategy does not work for synchronizing the activity of the patches.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0158239.s006" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.s006" xlink:type="simple">
<label>S6 File</label>
<caption>
<title>In this bidomain simulation of the TNNP model, the single excitatory pulse fails to eliminate spiral waves in the medium.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0158239.s007" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.s007" xlink:type="simple">
<label>S7 File</label>
<caption>
<title>In this bidomain simulation of the TNNP model, the optimal pulsing strategy eliminates spiral waves in the medium.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0158239.s008" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pone.0158239.s008" xlink:type="simple">
<label>S8 File</label>
<caption>
<title>In this bidomain simulation of the TNNP model, the series of 5 excitatory pulses at constant intervals fails to eliminate spiral waves in the medium.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Support for this work by National Science Foundation Grant NSF-1363243 is gratefully acknowledged.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0158239.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ideker</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Knisley</surname> <given-names>SB</given-names></name>. <article-title>Correlation among fibrillation, defibrillation, and cardiac pacing</article-title>. <source>Pacing and Clinical Electrophysiology</source>. <year>1995</year>;<volume>18</volume>(<issue>3</issue>):<fpage>512</fpage>–<lpage>525</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1540-8159.1995.tb02562.x" xlink:type="simple">10.1111/j.1540-8159.1995.tb02562.x</ext-link></comment> <object-id pub-id-type="pmid">7777416</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuck</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Cappato</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Siebels</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ruppel</surname> <given-names>R</given-names></name>. <article-title>Randomized comparison of antiarrhythmic drug therapy with implantable defibrillators in patients resuscitated from cardiac arrest: the cardiac arrest study Hamburg</article-title>. <source>Circulation</source>. <year>2000</year>;<volume>102</volume>:<fpage>748</fpage>–<lpage>754</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.CIR.102.7.748" xlink:type="simple">10.1161/01.CIR.102.7.748</ext-link></comment> <object-id pub-id-type="pmid">10942742</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>DiMarco</surname> <given-names>JP</given-names></name>. <article-title>Implantable cardioverter–defibrillators</article-title>. <source>New England Journal of Medicine</source>. <year>2003</year>;<volume>349</volume>(<issue>19</issue>):<fpage>1836</fpage>–<lpage>1847</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMra035432" xlink:type="simple">10.1056/NEJMra035432</ext-link></comment> <object-id pub-id-type="pmid">14602883</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jacq</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Foulldrin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Savouré</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Anselme</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Baguelin-Pinaud</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cribier</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>A comparison of anxiety, depression and quality of life between device shock and nonshock groups in implantable cardioverter defibrillator recipients</article-title>. <source>General Hospital Psychiatry</source>. <year>2009</year>;<volume>31</volume>(<issue>3</issue>):<fpage>266</fpage>–<lpage>273</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.genhosppsych.2009.01.003" xlink:type="simple">10.1016/j.genhosppsych.2009.01.003</ext-link></comment> <object-id pub-id-type="pmid">19410106</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suzuki</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Shiga</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kuwahara</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kobayashi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Suzuki</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nishimura</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Prevalence and Persistence of Depression in Patients with Implantable Cardioverter Defibrillator: A 2-year Longitudinal Study</article-title>. <source>Pacing and Clinical Electrophysiology</source>. <year>2010</year>;<volume>33</volume>(<issue>12</issue>):<fpage>1455</fpage>–<lpage>1461</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1540-8159.2010.02887.x" xlink:type="simple">10.1111/j.1540-8159.2010.02887.x</ext-link></comment> <object-id pub-id-type="pmid">20946285</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bilge</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Ozben</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Demircan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cinar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yilmaz</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Adalet</surname> <given-names>K</given-names></name>. <article-title>Depression and anxiety status of patients with implantable cardioverter defibrillator and precipitating factors</article-title>. <source>Pacing and Clinical Electrophysiology</source>. <year>2006</year>;<volume>29</volume>(<issue>6</issue>):<fpage>619</fpage>–<lpage>626</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1540-8159.2006.00409.x" xlink:type="simple">10.1111/j.1540-8159.2006.00409.x</ext-link></comment> <object-id pub-id-type="pmid">16784428</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Friedmann</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kao</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Inguito</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Metcalf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kelley</surname> <given-names>FJ</given-names></name>, <etal>et al</etal>. <article-title>Quality of life and psychological status of patients with implantable cardioverter defibrillators</article-title>. <source>American Journal of Critical Care</source>. <year>2006</year>;<volume>15</volume>(<issue>4</issue>):<fpage>389</fpage>–<lpage>398</lpage>. <object-id pub-id-type="pmid">16823016</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Epstein</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kay</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Plumb</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Dailey</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>P</given-names></name>. <article-title>Gross and macroscopic pathological changes associated with nonthoracotomy implantable defibrillator leads</article-title>. <source>Circulation</source>. <year>1998</year>;<volume>98</volume>:<fpage>1517</fpage>–<lpage>1524</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.CIR.98.15.1517" xlink:type="simple">10.1161/01.CIR.98.15.1517</ext-link></comment> <object-id pub-id-type="pmid">9769305</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Walcott</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ideker</surname> <given-names>CKR</given-names></name>. <article-title>Do clinically relevant transthoracic defibrillation energies cause myocardial damage and dysfunction?</article-title> <source>Resuscitation</source>. <year>2003</year>;<volume>59</volume>:<fpage>59</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0300-9572(03)00161-8" xlink:type="simple">10.1016/S0300-9572(03)00161-8</ext-link></comment> <object-id pub-id-type="pmid">14580735</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kroll</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Swerdlow</surname> <given-names>CD</given-names></name>. <article-title>Optimizing defibrillation waveforms for ICDs</article-title>. <source>Journal of Interventional Cardiac Electrophysiology</source>. <year>2007</year>;<volume>18</volume>(<issue>3</issue>):<fpage>247</fpage>–<lpage>263</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10840-007-9095-z" xlink:type="simple">10.1007/s10840-007-9095-z</ext-link></comment> <object-id pub-id-type="pmid">17541815</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zimmermann</surname> <given-names>JWN</given-names></name>, <name name-style="western"><surname>Lidolt</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Dees</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Perings</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vester</surname> <given-names>EG</given-names></name>, <name name-style="western"><surname>Poll</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Optimal method to achieve consistently low defibrillation energy requirements</article-title>. <source>The American Journal of Cardiology</source>. <year>2000</year>;<volume>86</volume>(<issue>9</issue>):<fpage>K71</fpage>–<lpage>K75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0002-9149(00)01294-7" xlink:type="simple">10.1016/S0002-9149(00)01294-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wathen</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>DeGroot</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Sweeney</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Stark</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Otterness</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Adkisson</surname> <given-names>WO</given-names></name>, <etal>et al</etal>. <article-title>Prospective randomized multicenter trial of empirical antitachycardia pacing versus shocks for spontaneous rapid ventricular tachycardia in patients with implantable cardioverter-defibrillators pacing fast ventricular tachycardia reduces shock therapies (PainFREE Rx II) trial results</article-title>. <source>Circulation</source>. <year>2004</year>;<volume>110</volume>(<issue>17</issue>):<fpage>2591</fpage>–<lpage>2596</lpage>. <object-id pub-id-type="pmid">15492306</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sweeney</surname> <given-names>MO</given-names></name>. <article-title>Antitachycardia pacing for ventricular tachycardia using implantable cardioverter defibrillators</article-title>. <source>Pacing and Clinical Electrophysiology</source>. <year>2004</year>;<volume>27</volume>(<issue>9</issue>):<fpage>1292</fpage>–<lpage>1305</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1540-8159.2004.00622.x" xlink:type="simple">10.1111/j.1540-8159.2004.00622.x</ext-link></comment> <object-id pub-id-type="pmid">15461721</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Luther</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fenton</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kornreich</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Squires</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bittihn</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hornung</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Low-energy control of electrical turbulence in the heart</article-title>. <source>Nature</source>. <year>2011</year>;<volume>475</volume>:<fpage>235</fpage>–<lpage>241</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10216" xlink:type="simple">10.1038/nature10216</ext-link></comment> <object-id pub-id-type="pmid">21753855</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ripplinger</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Lou</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Efimov</surname> <given-names>IR</given-names></name>. <article-title>Multiple monophasic shocks improve electrotherapy of ventricular tachycardia in a rabbit model of chronic infarction</article-title>. <source>Heart Rhythm</source>. <year>2009</year>;<volume>6</volume>(<issue>7</issue>):<fpage>1020</fpage>–<lpage>1027</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.hrthm.2009.03.015" xlink:type="simple">10.1016/j.hrthm.2009.03.015</ext-link></comment> <object-id pub-id-type="pmid">19560090</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fenton</surname> <given-names>FH</given-names></name>, <name name-style="western"><surname>Luther</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cherry</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Otani</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Krinsky</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Pumir</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Termination of atrial fibrillation using pulsed low-energy far-field stimulation</article-title>. <source>Circulation</source>. <year>2009</year>;<volume>120</volume>(<issue>6</issue>):<fpage>467</fpage>–<lpage>476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/CIRCULATIONAHA.108.825091" xlink:type="simple">10.1161/CIRCULATIONAHA.108.825091</ext-link></comment> <object-id pub-id-type="pmid">19635972</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ambrosi</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Ripplinger</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Efimov</surname> <given-names>IR</given-names></name>, <name name-style="western"><surname>Fedorov</surname> <given-names>VV</given-names></name>. <article-title>Termination of sustained atrial flutter and fibrillation using low-voltage multiple-shock therapy</article-title>. <source>Heart Rhythm</source>. <year>2011</year>;<volume>8</volume>(<issue>1</issue>):<fpage>101</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.hrthm.2010.10.018" xlink:type="simple">10.1016/j.hrthm.2010.10.018</ext-link></comment> <object-id pub-id-type="pmid">20969974</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Plonsey</surname> <given-names>R</given-names></name>. <article-title>The nature of sources of bioelectric and biomagnetic fields</article-title>. <source>Biophysical Journal</source>. <year>1982</year>;<volume>39</volume>(<issue>3</issue>):<fpage>309</fpage>–<lpage>312</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(82)84521-9" xlink:type="simple">10.1016/S0006-3495(82)84521-9</ext-link></comment> <object-id pub-id-type="pmid">7139030</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hooks</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Tomlinson</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Marsden</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>LeGrice</surname> <given-names>IJ</given-names></name>, <name name-style="western"><surname>Smaill</surname> <given-names>BH</given-names></name>, <name name-style="western"><surname>Pullan</surname> <given-names>AJ</given-names></name>, <etal>et al</etal>. <article-title>Cardiac microstructure implications for electrical propagation and defibrillation in the heart</article-title>. <source>Circulation Research</source>. <year>2002</year>;<volume>91</volume>(<issue>4</issue>):<fpage>331</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.RES.0000031957.70034.89" xlink:type="simple">10.1161/01.RES.0000031957.70034.89</ext-link></comment> <object-id pub-id-type="pmid">12193466</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dosdall</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Fast</surname> <given-names>VG</given-names></name>, <name name-style="western"><surname>Ideker</surname> <given-names>RE</given-names></name>. <article-title>Mechanisms of defibrillation</article-title>. <source>Annual Review of Biomedical Engineering</source>. <year>2010</year>;<volume>12</volume>:<fpage>233</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev-bioeng-070909-105305" xlink:type="simple">10.1146/annurev-bioeng-070909-105305</ext-link></comment> <object-id pub-id-type="pmid">20450352</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trayanova</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Skouibine</surname> <given-names>K</given-names></name>. <article-title>Modeling defibrillation: effects of fiber curvature</article-title>. <source>Journal of Electrocardiology</source>. <year>1998</year>;<volume>31</volume>:<fpage>23</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0022-0736(98)90274-6" xlink:type="simple">10.1016/S0022-0736(98)90274-6</ext-link></comment> <object-id pub-id-type="pmid">9988001</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Plonsey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Barr</surname> <given-names>RC</given-names></name>. <article-title>Effect of microscopic and macroscopic discontinuities on the response of cardiac tissue to defibrillating (stimulating) currents</article-title>. <source>Medical and Biological Engineering and Computing</source>. <year>1986</year>;<volume>24</volume>(<issue>2</issue>):<fpage>130</fpage>–<lpage>136</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF02443925" xlink:type="simple">10.1007/BF02443925</ext-link></comment> <object-id pub-id-type="pmid">3713273</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fast</surname> <given-names>VG</given-names></name>, <name name-style="western"><surname>Rohr</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gillis</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Kléber</surname> <given-names>AG</given-names></name>. <article-title>Activation of Cardiac Tissue by Extracellular Electrical Shocks Formation of ‘Secondary Sources’ at Intercellular Clefts in Monolayers of Cultured Myocytes</article-title>. <source>Circulation Research</source>. <year>1998</year>;<volume>82</volume>(<issue>3</issue>):<fpage>375</fpage>–<lpage>385</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.RES.82.3.375" xlink:type="simple">10.1161/01.RES.82.3.375</ext-link></comment> <object-id pub-id-type="pmid">9486666</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dillon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kwaku</surname> <given-names>K</given-names></name>. <article-title>A unified hypothesis for defibrillation and fibrillation induction by shocks</article-title>. <source>Journal of Cardiovascular Electrophysiology</source>. <year>1998</year>;<volume>9</volume>:<fpage>529</fpage>–<lpage>552</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1540-8167.1998.tb01847.x" xlink:type="simple">10.1111/j.1540-8167.1998.tb01847.x</ext-link></comment> <object-id pub-id-type="pmid">9607463</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trayanova</surname> <given-names>N</given-names></name>. <article-title>Concepts of ventricular defibrillation</article-title>. <source>Phil Trans R Soc Lond A</source>. <year>2001</year>;<volume>359</volume>:<fpage>1327</fpage>–<lpage>1337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsta.2001.0834" xlink:type="simple">10.1098/rsta.2001.0834</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gray</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chattipakorn</surname> <given-names>N</given-names></name>. <article-title>Termination of spiral waves during cardiac fibrillation via shock induced phase resetting</article-title>. <source>Proc of the Nat Acad Sci USA</source>. <year>2005</year>;<volume>102</volume>:<fpage>4672</fpage>–<lpage>4677</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0407860102" xlink:type="simple">10.1073/pnas.0407860102</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref027">
<label>27</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Trayanova</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Plank</surname> <given-names>G</given-names></name>. <chapter-title>Bidomain model of defibrillation</chapter-title>. In: <source>Cardiac Bioelectric Therapy</source>. <publisher-name>Springer</publisher-name>; <year>2009</year>. p. <fpage>85</fpage>–<lpage>109</lpage>.</mixed-citation>
</ref>
<ref id="pone.0158239.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vigmond</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>dos Santos</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Prassl</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Deo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Plank</surname> <given-names>G</given-names></name>. <article-title>Solvers for the cardiac bidomain equations</article-title>. <source>Progress in Biophysics and Molecular Biology</source>. <year>2008</year>;<volume>96</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.pbiomolbio.2007.07.012" xlink:type="simple">10.1016/j.pbiomolbio.2007.07.012</ext-link></comment> <object-id pub-id-type="pmid">17900668</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Karma</surname> <given-names>A</given-names></name>. <article-title>Electrical alternans and spiral wave breakup in cardiac tissue</article-title>. <source>Chaos</source>. <year>1994</year>;<volume>4</volume>(<issue>3</issue>):<fpage>461</fpage>–<lpage>472</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.166024" xlink:type="simple">10.1063/1.166024</ext-link></comment> <object-id pub-id-type="pmid">12780121</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spach</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Dolber</surname> <given-names>PC</given-names></name>. <article-title>Relating extracellular potentials and their derivatives to anisotropic propagation at a microscopic level in human cardiac muscle. Evidence for electrical uncoupling of side-to-side fiber connections with increasing age</article-title>. <source>Circulation Research</source>. <year>1986</year>;<volume>58</volume>(<issue>3</issue>):<fpage>356</fpage>–<lpage>371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.RES.58.3.356" xlink:type="simple">10.1161/01.RES.58.3.356</ext-link></comment> <object-id pub-id-type="pmid">3719925</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fareh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Leung</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Nattel</surname> <given-names>S</given-names></name>. <article-title>Promotion of atrial fibrillation by heart failure in dogs atrial remodeling of a different sort</article-title>. <source>Circulation</source>. <year>1999</year>;<volume>100</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>95</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.CIR.100.1.87" xlink:type="simple">10.1161/01.CIR.100.1.87</ext-link></comment> <object-id pub-id-type="pmid">10393686</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spach</surname> <given-names>MS</given-names></name>. <article-title>Mounting evidence that fibrosis generates a major mechanism for atrial fibrillation</article-title>. <source>Circulation Research</source>. <year>2007</year>;<volume>101</volume>(<issue>8</issue>):<fpage>743</fpage>–<lpage>745</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/CIRCRESAHA.107.163956" xlink:type="simple">10.1161/CIRCRESAHA.107.163956</ext-link></comment> <object-id pub-id-type="pmid">17932329</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moehlis</surname> <given-names>J</given-names></name>. <article-title>Extending Phase Reduction to Excitable Media: Theory and Applications</article-title>. <source>SIAM Review</source>. <year>2015</year>;<volume>57</volume>(<issue>2</issue>):<fpage>201</fpage>–<lpage>222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/140952478" xlink:type="simple">10.1137/140952478</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ichinose</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Aihara</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Judd</surname> <given-names>K</given-names></name>. <article-title>Extending the concept of isochrons from oscillatory to excitable systems for modeling an excitable neuron</article-title>. <source>International Journal of Bifurcation and Chaos</source>. <year>1998</year>;<volume>8</volume>(<issue>12</issue>):<fpage>2375</fpage>–<lpage>2385</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1142/S021812749800190X" xlink:type="simple">10.1142/S021812749800190X</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rabinovitch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rogachevskii</surname> <given-names>I</given-names></name>. <article-title>Threshold, excitability and isochrones in the Bonhoeffer–van der Pol system</article-title>. <source>Chaos</source>. <year>1999</year>;<volume>9</volume>(<issue>4</issue>):<fpage>880</fpage>–<lpage>886</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.166460" xlink:type="simple">10.1063/1.166460</ext-link></comment> <object-id pub-id-type="pmid">12779884</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moehlis</surname> <given-names>J</given-names></name>. <article-title>An Energy-Optimal Methodology for Synchronization of Excitable Media</article-title>. <source>SIAM Journal on Applied Dynamical Systems</source>. <year>2014</year>;<volume>13</volume>(<issue>2</issue>):<fpage>944</fpage>–<lpage>957</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/130942851" xlink:type="simple">10.1137/130942851</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref037">
<label>37</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Winfree</surname> <given-names>A</given-names></name>. <source>The Geometry of Biological Time</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pone.0158239.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ermentrout</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Kopell</surname> <given-names>N</given-names></name>. <article-title>Multiple pulse interactions and averaging in systems of coupled neural oscillators</article-title>. <source>Journal of Mathematical Biology</source>. <year>1991</year>;<volume>29</volume>(<issue>3</issue>):<fpage>195</fpage>–<lpage>217</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00160535" xlink:type="simple">10.1007/BF00160535</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref039">
<label>39</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hoppensteadt</surname> <given-names>FC</given-names></name>, <name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name>. <source>Weakly Connected Neural Networks</source>. <publisher-name>Springer</publisher-name>; <year>1997</year>.</mixed-citation>
</ref>
<ref id="pone.0158239.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moehlis</surname> <given-names>J</given-names></name>. <article-title>Optimal Chaotic Desynchronization for Neural Populations</article-title>. <source>SIAM Journal on Applied Dynamical Systems</source>. <year>2014</year>;<volume>13</volume>(<issue>1</issue>):<fpage>276</fpage>–<lpage>305</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/120901702" xlink:type="simple">10.1137/120901702</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref041">
<label>41</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Feller</surname> <given-names>W</given-names></name>. <source>An Introduction to Probability Theory and its Applications</source>. vol. <volume>2</volume>. <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pone.0158239.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kirk</surname> <given-names>D</given-names></name>. <source>Optimal Control Theory</source>. <publisher-loc>Mineola, New York</publisher-loc>: <publisher-name>Dover Publications</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pone.0158239.ref043">
<label>43</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bellman</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Dreyfus</surname> <given-names>SE</given-names></name>. <source>Applied Dynamic Programming</source>. <publisher-name>Princeton University Press</publisher-name>; <year>1962</year>.</mixed-citation>
</ref>
<ref id="pone.0158239.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roth</surname> <given-names>RJ</given-names></name>. <article-title>Electrical conductivity values used with the bidomain model of cardiac tissue</article-title>. <source>IEEE Transactions on Bio-Medical Engineering</source>. <year>1997</year>;<volume>44</volume>(<issue>4</issue>):<fpage>326</fpage>–<lpage>328</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/10.563303" xlink:type="simple">10.1109/10.563303</ext-link></comment> <object-id pub-id-type="pmid">9125816</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keener</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Bogar</surname> <given-names>K</given-names></name>. <article-title>A numerical method for the solution of the bidomain equations in cardiac tissue</article-title>. <source>Chaos</source>. <year>1998</year>;<volume>8</volume>(<issue>1</issue>):<fpage>234</fpage>–<lpage>241</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.166300" xlink:type="simple">10.1063/1.166300</ext-link></comment> <object-id pub-id-type="pmid">12779724</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref046">
<label>46</label>
<mixed-citation publication-type="other" xlink:type="simple">Bell N, Garland M. Cusp: Generic parallel algorithms for sparse matrix and graph computations; 2013.</mixed-citation>
</ref>
<ref id="pone.0158239.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Duncan</surname> <given-names>OD</given-names></name>, <name name-style="western"><surname>Duncan</surname> <given-names>B</given-names></name>. <article-title>Residential distribution and occupational stratification</article-title>. <source>American Journal of Sociology</source>. <year>1955</year>; p. <fpage>493</fpage>–<lpage>503</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/221609" xlink:type="simple">10.1086/221609</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Faddy</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Powell</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Craig</surname> <given-names>JC</given-names></name>. <article-title>Biphasic and monophasic shocks for transthoracic defibrillation: a meta analysis of randomised controlled trials</article-title>. <source>Resuscitation</source>. <year>2003</year>;<volume>58</volume>(<issue>1</issue>):<fpage>9</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0300-9572(03)00077-7" xlink:type="simple">10.1016/S0300-9572(03)00077-7</ext-link></comment> <object-id pub-id-type="pmid">12867304</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schneider</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Martens</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Paschen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kuisma</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wolcke</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gliner</surname> <given-names>BE</given-names></name>, <etal>et al</etal>. <article-title>Multicenter, randomized, controlled trial of 150-J biphasic shocks compared with 200-to 360-J monophasic shocks in the resuscitation of out-of-hospital cardiac arrest victims</article-title>. <source>Circulation</source>. <year>2000</year>;<volume>102</volume>(<issue>15</issue>):<fpage>1780</fpage>–<lpage>1787</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.CIR.102.15.1780" xlink:type="simple">10.1161/01.CIR.102.15.1780</ext-link></comment> <object-id pub-id-type="pmid">11023932</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kroll</surname> <given-names>M</given-names></name>. <article-title>A minimal model of the single capacitor biphasic defibrillation waveform</article-title>. <source>Pacing and Clinical Electrophysiology</source>. <year>1995</year>;<volume>17</volume>:<fpage>1782</fpage>–<lpage>1792</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1540-8159.1994.tb03746.x" xlink:type="simple">10.1111/j.1540-8159.1994.tb03746.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Swerdlow</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Fan</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Brewer</surname> <given-names>JE</given-names></name>. <article-title>Charge-burping theory correctly predicts optimal ratios of phase duration for biphasic defibrillation waveforms</article-title>. <source>Circulation</source>. <year>1996</year>;<volume>94</volume>(<issue>9</issue>):<fpage>2278</fpage>–<lpage>2284</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.CIR.94.9.2278" xlink:type="simple">10.1161/01.CIR.94.9.2278</ext-link></comment> <object-id pub-id-type="pmid">8901683</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tusscher</surname> <given-names>KHWJT</given-names></name>, <name name-style="western"><surname>Panfilov</surname> <given-names>AV</given-names></name>. <article-title>Alternans and spiral breakup in a human ventricular tissue model</article-title>. <source>American Journal of Physiology-Heart and Circulatory Physiology</source>. <year>2006</year>;<volume>291</volume>(<issue>3</issue>):<fpage>H1088</fpage>–<lpage>H1100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/ajpheart.00109.2006" xlink:type="simple">10.1152/ajpheart.00109.2006</ext-link></comment> <object-id pub-id-type="pmid">16565318</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rush</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Larsen</surname> <given-names>H</given-names></name>. <article-title>A practical algorithm for solving dynamic membrane equations</article-title>. <source>Biomedical Engineering, IEEE Transactions on</source>. <year>1978</year>;(<volume>4</volume>):<fpage>389</fpage>–<lpage>392</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TBME.1978.326270" xlink:type="simple">10.1109/TBME.1978.326270</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roth</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Jr</surname> <given-names>JPW</given-names></name>. <article-title>Electrical stimulation of cardiac tissue: a bidomain model with active membrane properties</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>1994</year>;<volume>41</volume>(<issue>3</issue>):<fpage>232</fpage>–<lpage>240</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/10.284941" xlink:type="simple">10.1109/10.284941</ext-link></comment> <object-id pub-id-type="pmid">8045575</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Laughner</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Ng</surname> <given-names>FS</given-names></name>, <name name-style="western"><surname>Sulkin</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Arthur</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Efimov</surname> <given-names>IR</given-names></name>. <article-title>Processing and analysis of cardiac optical mapping data obtained with potentiometric dyes</article-title>. <source>American Journal of Physiology-Heart and Circulatory Physiology</source>. <year>2012</year>;<volume>303</volume>(<issue>7</issue>):<fpage>H753</fpage>–<lpage>H765</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/ajpheart.00404.2012" xlink:type="simple">10.1152/ajpheart.00404.2012</ext-link></comment> <object-id pub-id-type="pmid">22821993</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Efimov</surname> <given-names>IR</given-names></name>, <name name-style="western"><surname>Nikolski</surname> <given-names>VP</given-names></name>, <name name-style="western"><surname>Salama</surname> <given-names>G</given-names></name>. <article-title>Optical imaging of the heart</article-title>. <source>Circulation Research</source>. <year>2004</year>;<volume>95</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/01.RES.0000130529.18016.35" xlink:type="simple">10.1161/01.RES.0000130529.18016.35</ext-link></comment> <object-id pub-id-type="pmid">15242982</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cherry</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Fenton</surname> <given-names>FH</given-names></name>. <article-title>Suppression of alternans and conduction blocks despite steep APD restitution: electrotonic, memory, and conduction velocity restitution effects</article-title>. <source>American Journal of Physiology-Heart and Circulatory Physiology</source>. <year>2004</year>;<volume>286</volume>(<issue>6</issue>):<fpage>H2332</fpage>–<lpage>H2341</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/ajpheart.00747.2003" xlink:type="simple">10.1152/ajpheart.00747.2003</ext-link></comment> <object-id pub-id-type="pmid">14751863</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cherry</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>SJ</given-names></name>. <article-title>Properties of two human atrial cell models in tissue: restitution, memory, propagation, and reentry</article-title>. <source>Journal of Theoretical Biology</source>. <year>2008</year>;<volume>254</volume>(<issue>3</issue>):<fpage>674</fpage>–<lpage>690</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2008.06.030" xlink:type="simple">10.1016/j.jtbi.2008.06.030</ext-link></comment> <object-id pub-id-type="pmid">18652834</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ripplinger</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Krinsky</surname> <given-names>VI</given-names></name>, <name name-style="western"><surname>Nikolski</surname> <given-names>VP</given-names></name>, <name name-style="western"><surname>Efimov</surname> <given-names>IR</given-names></name>. <article-title>Mechanisms of unpinning and termination of ventricular tachycardia</article-title>. <source>American Journal of Physiology-Heart and Circulatory Physiology</source>. <year>2006</year>;<volume>291</volume>(<issue>1</issue>):<fpage>H184</fpage>–<lpage>H192</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/ajpheart.01300.2005" xlink:type="simple">10.1152/ajpheart.01300.2005</ext-link></comment> <object-id pub-id-type="pmid">16501014</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cysyk</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tung</surname> <given-names>L</given-names></name>. <article-title>Electric field perturbations of spiral waves attached to millimeter-size obstacles</article-title>. <source>Biophysical Journal</source>. <year>2008</year>;<volume>94</volume>(<issue>4</issue>):<fpage>1533</fpage>–<lpage>1541</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.107.116244" xlink:type="simple">10.1529/biophysj.107.116244</ext-link></comment> <object-id pub-id-type="pmid">17921205</object-id></mixed-citation>
</ref>
<ref id="pone.0158239.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bittihn</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Squires</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Luther</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bodenschatz</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Krinsky</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Parlitz</surname> <given-names>U</given-names></name>, <etal>et al</etal>. <article-title>Phase-resolved analysis of the susceptibility of pinned spiral waves to far-field pacing in a two-dimensional model of excitable media</article-title>. <source>Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences</source>. <year>2010</year>;<volume>368</volume>(<issue>1918</issue>):<fpage>2221</fpage>–<lpage>2236</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsta.2010.0038" xlink:type="simple">10.1098/rsta.2010.0038</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0158239.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fishler</surname> <given-names>MG</given-names></name>. <article-title>Theoretical predictions of the optimal monophasic and biphasic defibrillation waveshapes</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2000</year>;<volume>47</volume>(<issue>1</issue>):<fpage>59</fpage>–<lpage>67</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/10.817620" xlink:type="simple">10.1109/10.817620</ext-link></comment> <object-id pub-id-type="pmid">10646280</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>