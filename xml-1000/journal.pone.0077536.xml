<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group>
<journal-title>PLoS ONE</journal-title></journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-13-16125</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0077536</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>On the Quantification of SSVEP Frequency Responses in Human EEG in Realistic BCI Conditions</article-title>
<alt-title alt-title-type="running-head">Quantification of SSVEP Frequency Responses</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kuś</surname><given-names>Rafał</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Duszyk</surname><given-names>Anna</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Milanowski</surname><given-names>Piotr</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Łabęcki</surname><given-names>Maciej</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bierzyńska</surname><given-names>Maria</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Radzikowska</surname><given-names>Zofia</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Michalska</surname><given-names>Magdalena</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Żygierewicz</surname><given-names>Jarosław</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Suffczyński</surname><given-names>Piotr</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Durka</surname><given-names>Piotr Jerzy</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Faculty of Physics, University of Warsaw, Warsaw, Poland</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Psychology, University of Social Sciences and Humanities, Warsaw, Poland</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Molecular and Cellular Neurobiology, Nencki Institute of Experimental Biology, Warsaw, Poland</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Barnes</surname><given-names>Gareth Robert</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University College of London – Institute of Neurology, United Kingdom</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">rkus@fuw.edu.pl</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: RK AD MŁ MM. Performed the experiments: AD MŁ MB ZR MM. Analyzed the data: RK PM MŁ JZ. Contributed reagents/materials/analysis tools: RK JZ PM. Wrote the paper: RK AD PM MŁ MB ZR MM JŻ PS PD.</p></fn>
</author-notes>
<pub-date pub-type="collection"><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>18</day><month>10</month><year>2013</year></pub-date>
<volume>8</volume>
<issue>10</issue>
<elocation-id>e77536</elocation-id>
<history>
<date date-type="received"><day>17</day><month>4</month><year>2013</year></date>
<date date-type="accepted"><day>3</day><month>9</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Kuś et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>This article concerns one of the most important problems of brain-computer interfaces (BCI) based on Steady State Visual Evoked Potentials (SSVEP), that is the selection of the a-priori most suitable frequencies for stimulation. Previous works related to this problem were done either with measuring systems that have little in common with actual BCI systems (e.g., single flashing LED) or were presented on a small number of subjects, or the tested frequency range did not cover a broad spectrum. Their results indicate a strong SSVEP response around 10 Hz, in the range 13–25 Hz, and at high frequencies in the band of 40–60 Hz. In the case of BCI interfaces, stimulation with frequencies from various ranges are used. The frequencies are often adapted for each user separately. The selection of these frequencies, however, was not yet justified in quantitative group-level study with proper statistical account for inter-subject variability. The aim of this study is to determine the SSVEP response curve, that is, the magnitude of the evoked signal as a function of frequency. The SSVEP response was induced in conditions as close as possible to the actual BCI system, using a wide range of frequencies (5–30 Hz, in step of 1 Hz). The data were obtained for 10 subjects. SSVEP curves for individual subjects and the population curve was determined. Statistical analysis were conducted both on the level of individual subjects and for the group. The main result of the study is the identification of the optimal range of frequencies, which is 12–18 Hz, for the registration of SSVEP phenomena. The applied criterion of optimality was: to find the largest contiguous range of frequencies yielding the strong and constant-level SSVEP response.</p>
</abstract>
<funding-group><funding-statement>The work was partially supported by the Ventures Programme of Foundation for Polish Science operated within the Innovative Economy Operational Programme (IE OP) 2007–2013 within European Regional Development Fund. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. The additional part of the funding was from Polish funds for science.</funding-statement></funding-group><counts><page-count count="9"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Brain responses to repetitive sensory stimulus have been studied for decades. For instance Regan <xref ref-type="bibr" rid="pone.0077536-Regan1">[1]</xref> has observed that a rapidly repeating stimulus, such as a flickering light of certain frequency, may induce response in corresponding frequencies (that of stimulation and higher harmonics) in the EEG recorded over visual areas of the scalp. These brain responses have been named steady-state visual evoked potentials (SSVEP). This phenomenon is commonly used in Brain-Computer Interface (BCI) systems <xref ref-type="bibr" rid="pone.0077536-Brunner1">[2]</xref>. A graphical interface of the SSVEP-based BCI system usually consists of different commands, e.g. letters or symbols, that flicker at specific frequencies. User pays attention to a particular flickering command, while ignoring others, which induces SSVEP with the corresponding frequency. BCI system identifies the user intention by quantifying and classifying SSVEP. Proper choice of flicker frequencies and accurate estimation of the response magnitude are critical for BCI. Although it is generally acknowledged that the SSVEP response depends on the frequency of the stimulation, there are relatively few studies investigating this relation in detail. Regan <xref ref-type="bibr" rid="pone.0077536-Regan2">[3]</xref> has shown that the dependence of the amplitude of SSVEP on the flicker frequency generally exhibits three distinct maxima. The ‘low-frequency’ response with a maximum around 10 Hz, the ‘medium-frequency’ response in 13–25 Hz range and ‘high-frequency’ response in 40–60 Hz range. Similar results have been subsequently obtained in other studies.</p>
<p>In <xref ref-type="bibr" rid="pone.0077536-Wang1">[4]</xref>, a representative dependence of SSVEP amplitude on frequency response of one subject exhibits three maxima centered on 15, 31 and 41 Hz. Pastor <xref ref-type="bibr" rid="pone.0077536-Pastor1">[5]</xref> investigated the EEG oscillatory responses to flicker stimulation for selected frequencies in the 5–60 Hz range. The response amplitude was largest at 15 Hz in the occipital area and at 25 Hz in the frontal areas. Herrmann <xref ref-type="bibr" rid="pone.0077536-Herrmann1">[6]</xref> investigated the EEG responses to flicker stimulation in the frequency range 1–100 Hz with 1 Hz resolution. His main finding was that the brain exhibits resonant frequencies around 10, 20, 40 and 80 Hz. The relative magnitudes of response frequencies were not the main objective of the study, hence the results do not pertain directly to BCI systems, e.g., the curve representing average response magnitude across 10 subjects was not smooth and exhibited several maxima and minima. The standard error of the mean was not provided hence it is not possible to assess statistical significance of the peaks.</p>
<p>Although the dependence of response magnitude on stimulation frequency has been investigated in several studies, and is commonly used to guide the selection of stimulation frequencies, there is no consensus regarding the optimal frequencies for the SSVEP-based BCIs. This is reflected in very diversified frequencies adopted in various studies. Some authors used narrow ‘low-frequency’ band, e.g. 6.666–8.571 Hz <xref ref-type="bibr" rid="pone.0077536-Cecotti1">[7]</xref>, 5–9.9 Hz <xref ref-type="bibr" rid="pone.0077536-Hwang1">[8]</xref>, while others used medium frequency range, e.g. 14–18 Hz <xref ref-type="bibr" rid="pone.0077536-LopezGordo1">[9]</xref> or even higher frequencies e.g., 27–43 Hz <xref ref-type="bibr" rid="pone.0077536-Lin1">[10]</xref>. The application of frequencies from the alpha band (8–13 Hz) is also not consistent across studies. While in some BCI applications, frequencies from the alpha band are excluded (e.g., 6, 7, 8 and 13 Hz <xref ref-type="bibr" rid="pone.0077536-MullerPutz1">[11]</xref>), they are included in some other studies (e.g. 6.67, 7.50, 8.57, 10.00, 12.00 Hz <xref ref-type="bibr" rid="pone.0077536-Volosyak1">[12]</xref>). The widespread diversity of the stimulation frequencies across studies indicates that there is still a need to find out which frequencies may provide an optimal performance of the SSVEP-based BCI.</p>
<p>The goal of this study is to provide a link between fundamental research and its applications in designing knowledge-based BCI systems with maximum performance. For this purpose we investigate the SSVEP responses in the wide range of responsive stimulation frequencies, using a 4-class SSVEP-based BCI. To the best of our knowledge, this topic has not been investigated in detail previously, in the settings corresponding to real BCI application.</p>
</sec><sec id="s2" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s2a">
<title>Subjects and Data Collection</title>
<p>Ten subjects participated in this study. All right–handed, 5 males and 5 females, mean age: 28.7 years, range: 24–41. EEG was recorded by means of 19 Ag/Ag-Cl electrodes placed on the surface of the scalp according to the international 10–20 system. All the electrodes from this system, except Fp1 and Fp2, were used to further analysis. The ground electrode was placed over the clavicle of the subject and the reference electrodes were placed over the left and right mastoid (M1 and M2). The impedance of the electrodes was below 5 k<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e001" xlink:type="simple"/></inline-formula>. The signal was acquired by Porti7 (TMSI) amplifier with sampling frequency 1024 Hz.</p>
</sec><sec id="s2b">
<title>Visual stimulation</title>
<p>Subjects were seated on a comfortable chair, in a dim room. Visual stimulation was delivered using a custom made BCI stimulator <xref ref-type="bibr" rid="pone.0077536-Durka1">[13]</xref>, placed at 100 cm in front of the subject. It consisted of liquid crystal display (LCD) backlit by an array of LEDs. The LCD (19.5 by 35 cm) was divided into four square fields, 4.5 cm by 4.5 cm each in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e002" xlink:type="simple"/></inline-formula> arrangement, separated by 4 cm of blank space. The size of the single square field, observed from the distance of 100 cm, was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e003" xlink:type="simple"/></inline-formula>2.6 degrees of visual angle and the distance between the centers of two adjacent fields was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e004" xlink:type="simple"/></inline-formula>4.9 degrees. This geometry implies that that if the subject focused on the center of the target field the target stimulus would be situated in foveal vision and the neighbouring ones would be localized in peripheral vision. Such localization of flickering fields should reduce the interference of neighbouring stimuli in the EEG signal <xref ref-type="bibr" rid="pone.0077536-Fuchs1">[14]</xref>–<xref ref-type="bibr" rid="pone.0077536-Ng2">[16]</xref> and the distraction of attention of the subject, yet it requires only relatively small eye movement to change the attended field. The luminance of stimuli emitted by single square field was 30 lx. Each LED highlighted a single field of the display. The LEDs were controlled by a micro-controller (MCU). The MCU drove the LEDs with square wave of stable frequency and duty cycle equal to 0.5. Each LED could flicker with a different frequency.</p>
</sec><sec id="s2c">
<title>Experimental Paradigm</title>
<p>The schematic sequence of events is presented in <xref ref-type="fig" rid="pone-0077536-g001">Fig. 1</xref>. The experiment consisted of 4 s long stimulation periods interleaved by 6 s long resting periods. During the resting period the LCD panel was turned off. During the stimulation intervals, in order to create experimental conditions corresponding to SSVEP paradigm used in BCI systems, all four fields were simultaneously active, each flickering with different frequency. Two seconds before stimulation onset the subject was instructed by a voice command to which of the four fields he or she should attend. Thus we consider two experimental conditions: Visual Stimulation (VS) with given frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e011" xlink:type="simple"/></inline-formula> and No Visual Stimulation (NVS) (<xref ref-type="fig" rid="pone-0077536-g002">Fig. 2</xref>). Further data analysis will consider mainly the VS condition. Both the position of the attended segment and its flickering frequency were randomly selected to avoid habituation. The subject was stimulated 50 times with each integer frequency between 5 and 30 Hz, i.e. 5, 6, 7,. 29, 30 Hz. Due to the length of the test, the experiment was divided into five sessions of 40 minutes. In each session the subject was stimulated with 10 repetitions of each frequency. For each subject, the full test was split into two meetings (two and three sessions, or vice versa). The length of the break between sessions during one day usually lasted about 15 minutes.</p>
<fig id="pone-0077536-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0077536.g001</object-id><label>Figure 1</label><caption>
<title>Scheme of the experimental paradigm.</title>
<p>In resting epochs the screen remains blank, whereas during stimulation each field flashes with the indicated frequency. The task of the subject is to focus attention on the field indicated by a voice command issued two seconds before the stimulation onset. Indicated field is marked red.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0077536.g001" position="float" xlink:type="simple"/></fig><fig id="pone-0077536-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0077536.g002</object-id><label>Figure 2</label><caption>
<title>Scheme of a single experimental trial.</title>
<p>Resting period lasted 6(at 0 s.), the subject was instructed by a voice command to which of the fields he or she should attend. The signals from −6 to −2 s. of the resting epoch and signal from 0 to 4 s. of the stimulation epoch were selected for further analysis as No Visual Stimulation Epochs and Visual Stimulation Epochs, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0077536.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s2d">
<title>Ethics statement</title>
<p>The study was approved by the Research Ethics Committee at University of Social Sciences and Humanities in Warsaw, Poland. All subjects declared the absence of neurological or mental illnesses, and were screened against the photosensitive epilepsy by the standard clinical EEG test. Informed, written consent was obtained from all of the subjects.</p>
</sec><sec id="s2e">
<title>Data analysis</title>
<p>There are two important issues concerning the assessment of the magnitude of the SSVEP response. The first comes from the fact that the EEG signal contains both the activity related to visual stimuli and activity related to other processes. Second issue relates to the definition of the measure, which would quantify the SSVEP in an efficient way, relevant to the prospective application. Because of these issues, application of appropriate signal preprocessing and processing algorithms to extract the relevant activity is the central point of any SSVEP-based BCI. In the following sections we focus on techniques which are feasible in potential BCI application, that is those, that after a calibration session can be applied on-line.</p>
<sec id="s2e1">
<title>Extraction of resting and stimulation epochs</title>
<p>From the EEG signal we extract segments of interest: 4 s long epochs of signal preceding the stimulation onset by 2 s, denoted as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e014" xlink:type="simple"/></inline-formula>, and 4 s long epochs of signal during the stimulation with frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e015" xlink:type="simple"/></inline-formula>, denoted as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e016" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e017" xlink:type="simple"/></inline-formula> denotes a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e018" xlink:type="simple"/></inline-formula> real number matrix, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e019" xlink:type="simple"/></inline-formula> is the number of channels and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e020" xlink:type="simple"/></inline-formula> is the number of samples (<xref ref-type="fig" rid="pone-0077536-g002">Fig. 2</xref>).</p>
</sec><sec id="s2e2">
<title>Spatial Filtering</title>
<p>The recorded signal contains response to light stimulation and background EEG activity. To increase the ratio of the SSVEP magnitude to the magnitude of the background activity, we applied Common Spatial Pattern filter (CSP) <xref ref-type="bibr" rid="pone.0077536-Koles1">[17]</xref>–<xref ref-type="bibr" rid="pone.0077536-Koles4">[20]</xref>. This filter, in case of two multichannel time-series, yields a linear combination of the original channels such that the variance of one of the resulting signals is maximized for one of the time-series and simultaneously it is minimized for the other time-series. It is expected, that the most prominent changes in EEG signal, during the flickering stimulation, will be observed in the frequency of stimulation. All data segments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e021" xlink:type="simple"/></inline-formula> were band-pass filtered by means of 1-st order Chebyshev Type II filter with pass-band centered at frequencies of interest <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e022" xlink:type="simple"/></inline-formula>. The width of the pass-band was 2 Hz (from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e023" xlink:type="simple"/></inline-formula> Hz to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e024" xlink:type="simple"/></inline-formula> Hz). The time series filtered around frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e025" xlink:type="simple"/></inline-formula> are denoted as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e026" xlink:type="simple"/></inline-formula>.</p>
<p>The CSP transformation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e027" xlink:type="simple"/></inline-formula> was estimated separately for each stimulation frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e028" xlink:type="simple"/></inline-formula>, since their spatial filters might not be identical. The matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e029" xlink:type="simple"/></inline-formula> can be obtained as a solution of the generalized eigenvalue problem <xref ref-type="bibr" rid="pone.0077536-Fukunaga1">[21]</xref>:<disp-formula id="pone.0077536.e030"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0077536.e030" xlink:type="simple"/><label>(1)</label></disp-formula>where: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e031" xlink:type="simple"/></inline-formula> is the mean covariance matrix estimated by ensemble averaging of the single trial covariances matrices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e032" xlink:type="simple"/></inline-formula> – it describes the covariance structure of the signal of interest, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e033" xlink:type="simple"/></inline-formula> is the mean covariance matrix estimated by ensemble averaging of the single trial covariances matrices of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e034" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e035" xlink:type="simple"/></inline-formula> – it describes the covariance structure of the background activity in adjacent frequencies; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e036" xlink:type="simple"/></inline-formula> is a diagonal matrix of eigenvalues and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e037" xlink:type="simple"/></inline-formula> is a full matrix whose columns are corresponding eigenvectors so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e038" xlink:type="simple"/></inline-formula>. Next, the original signals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e039" xlink:type="simple"/></inline-formula> were transformed by the estimated CSP filter:</p>
<p><disp-formula id="pone.0077536.e040"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0077536.e040" xlink:type="simple"/><label>(2)</label></disp-formula>The CSP filter, like other Blind Source Separation techniques, does not guarantee that the transformed signals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e041" xlink:type="simple"/></inline-formula> contain the brain electrical activity separated into physiologically meaningful components. But, by the construction of the CSP filter, the channel corresponding to the highest eigenvalue in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e042" xlink:type="simple"/></inline-formula>, has the maximal variance for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e043" xlink:type="simple"/></inline-formula> condition and lowest variance for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e044" xlink:type="simple"/></inline-formula> condition. Further, the covariance matrices were estimated by ensemble averaging, thus the considerable contribution to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e045" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e046" xlink:type="simple"/></inline-formula> will be derived from the EEG activity which has persistent covariance structure over the trials. That's why we assume that channel corresponding to the highest eigenvalue in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e047" xlink:type="simple"/></inline-formula>, denoted as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e048" xlink:type="simple"/></inline-formula>, will contain the activity related to SSVEP. The validation of this assumption will be presented in the Results section.</p>
</sec><sec id="s2e3">
<title>Spatial Patterns</title>
<p>It is very important to understand the relationship between the spatial filters, represented by each row of the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e049" xlink:type="simple"/></inline-formula> and the corresponding spatial patterns. The CSP filter, in given output channel, produces a signal containing the activity uncorrelated to activity in other output channels. Assuming that this activity is generated by some sources, one can compute the projection of their activity on the scalp. From (2) one gets:<disp-formula id="pone.0077536.e050"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0077536.e050" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p>Each column of matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e051" xlink:type="simple"/></inline-formula> gives the contribution of the corresponding source to the EEG signal and it is called spatial pattern of signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e052" xlink:type="simple"/></inline-formula>. It can be visualized as a plot showing its spatial distribution. The comparison of the obtained spatial filter and spatial patterns will be shown in the Results section.</p>
</sec><sec id="s2e4">
<title>Spectral power</title>
<p>The signals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e053" xlink:type="simple"/></inline-formula>, (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e054" xlink:type="simple"/></inline-formula>) corresponding to given stimulation frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e055" xlink:type="simple"/></inline-formula> (both NVS and VS epochs) were first transformed by relevant CSP filter, then the spectral power estimates, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e056" xlink:type="simple"/></inline-formula>, were computed for the channel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e057" xlink:type="simple"/></inline-formula>, which corresponds to the highest eigenvalue in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e058" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e059" xlink:type="simple"/></inline-formula> is obtained by evaluating the spectral power at frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e060" xlink:type="simple"/></inline-formula> by means of periodogram with Tukey window with parameter equal to 0.1. For the convenience of between subject comparison the average spectra were normalized to the maximal value obtained for the VS condition for a given subject:<disp-formula id="pone.0077536.e061"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0077536.e061" xlink:type="simple"/><label>(4)</label></disp-formula>where: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e062" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e063" xlink:type="simple"/></inline-formula> averaged over experiment realizations with given stimulation frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e064" xlink:type="simple"/></inline-formula> for a given subject.</p>
</sec><sec id="s2e5">
<title>Signal to Noise Ratio</title>
<p>Spectral power of EEG decreases with frequency. This property implies that response to high-frequency stimulation has less absolute power than response to low-frequency one. Therefore SSVEP can be better quantified as a relative increase of power at the stimulation frequency, with respect to its baseline value. The quantity, often used to measures the relative increase or decrease of the EEG power, is Event Related Spectral Perturbation <xref ref-type="bibr" rid="pone.0077536-Makeig1">[22]</xref>. However in context of on-line computations, relying on baseline values is not convenient. A more practical approach, especially applicable for SSVEP, was proposed in <xref ref-type="bibr" rid="pone.0077536-Wang2">[23]</xref>. It measures the activity level at a given stimulation frequency (regarded as signal level) with respect to the level of activity in adjacent frequencies (regarded as noise level). Expressed as a ratio of corresponding powers this measure is an estimator of Signal-to-Noise-Ratio (SNR) for a given realization of experiment:<disp-formula id="pone.0077536.e065"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0077536.e065" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>we used: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e066" xlink:type="simple"/></inline-formula> = 6, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e067" xlink:type="simple"/></inline-formula> = 0.25 Hz. This estimator of SNR was used as a feature for classification in BCI e.g. in <xref ref-type="bibr" rid="pone.0077536-Molina1">[28]</xref>. In order to compare the average SNR between subjects we propose to normalize it for each subject by its maximal value:<disp-formula id="pone.0077536.e068"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pone.0077536.e068" xlink:type="simple"/><label>(6)</label></disp-formula>where: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e069" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e070" xlink:type="simple"/></inline-formula> averaged over experiment realizations with given stimulation frequency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e071" xlink:type="simple"/></inline-formula> for a given subject.</p>
</sec></sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Spatial Filters and Spatial Patterns</title>
<p>Examples of spatial filters and spatial patterns corresponding to the highest eigenvalue for each subject and for subset of stimulation frequencies is presented on the <xref ref-type="fig" rid="pone-0077536-g003">Fig. 3</xref>. One can observe, that the spatial patterns in most cases have clear dipolar form with extremum at the parietal and occipital electrodes, compatible with a hypothetical SSVEP source located in visual cortex. In most cases the pattern is symmetric, with extremum around electrodes O1 and O2 (e.g. subject S8), but in some cases it is asymmetric, with extremum either around the electrode O2 (e.g. subject S1 at frequency 21 Hz) or electrode O1 (e.g. subject S1 at frequency 11 Hz). Only five subjects (S8, S2, S7, S3, S9) have almost constant spatial pattern across frequencies. For the rest of the subjects the spatial pattern varies with frequency.</p>
<fig id="pone-0077536-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0077536.g003</object-id><label>Figure 3</label><caption>
<title>Visualisation of the spatial filters and spatial patterns corresponding to the highest eigenvalue (eq. 2 and 3).</title>
<p>Four left columns – spatial filters, four right columns – spatial patterns at stimulation frequencies: 5 Hz, 11 Hz, 16 Hz, 21 Hz and 26 Hz. Each row presents results for one subject. Color code: red positive, blue negative values.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0077536.g003" position="float" xlink:type="simple"/></fig>
<p>The spatial patterns, although not constant, are generally consistent (up to sign) within and between subjects. But the spatial filters show much larger variability. This diversity results from different activity not related to SSVEP in different frequency bands (e.g. background EEG, muscle activity). The aim of the spatial filters is minimization of this additional activity in favor of SSVEP, thus the obtained spatial filters differ for the different stimulation frequencies.</p>
</sec><sec id="s3b">
<title>SSVEP Frequency Response</title>
<sec id="s3b1">
<title>Course of the response curve</title>
<p>SSVEP frequency responses obtained by means of normalized spectral power <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e072" xlink:type="simple"/></inline-formula> are shown in the left column of <xref ref-type="fig" rid="pone-0077536-g004">Fig. 4</xref> for all individual subjects (rows 1–10); the last row shows the responses averaged across subjects. The maxima of the response curve correspond to the presence of three frequency ranges of EEG rhythms: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e073" xlink:type="simple"/></inline-formula> (5–7.5 Hz), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e074" xlink:type="simple"/></inline-formula> (8–13 Hz) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e075" xlink:type="simple"/></inline-formula> (above 14 Hz) <xref ref-type="bibr" rid="pone.0077536-Niedermeyer1">[24]</xref>. For half of the subjects (S1, S2, S3, S4, S5 and S10) there is a pronounced peak in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e076" xlink:type="simple"/></inline-formula> centered in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e077" xlink:type="simple"/></inline-formula> band. Only for some of them it corresponds exactly to the peak in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e078" xlink:type="simple"/></inline-formula> (S2, S4 and S5). Two of the subjects have a broad peak in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e079" xlink:type="simple"/></inline-formula> extending from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e080" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e081" xlink:type="simple"/></inline-formula> band (S7, S8), and two of them have the peak shifted towards <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e082" xlink:type="simple"/></inline-formula> range (S6, S9). In the average response curve, one can see that the highest values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e083" xlink:type="simple"/></inline-formula> are obtained for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e084" xlink:type="simple"/></inline-formula> range, but they have considerably higher root-mean-square (RMS) error than these in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e085" xlink:type="simple"/></inline-formula> range.</p>
<fig id="pone-0077536-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0077536.g004</object-id><label>Figure 4</label><caption>
<title>SSVEP frequency response curves.</title>
<p>Columns correspond to the method of SSVEP evaluation: Left – spectral power, right – Signal to Noise Ratio. Rows 1–10 correspond to individual subjects, last row shows the response averaged across 10 subjects. Horizontal axis – stimulation frequency. Vertical axes have two scales. In the left column: left scale – normalized power <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e005" xlink:type="simple"/></inline-formula>, right scale – absolute mean power <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e006" xlink:type="simple"/></inline-formula>. In the right column: left scale – values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e007" xlink:type="simple"/></inline-formula>, right scale – values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e008" xlink:type="simple"/></inline-formula>. Error bars indicate the RMS error. Each plot presents two curves: the blue line shows values obtained for NVS, and the red one for VS condition. The gray regions in rows 1–10 mark the frequencies, where the given measure (column) gives significantly higher result for VS than NVS epochs for the a given subject (row) – results of within-subject level tests. The gray color on the plots in the last row means significant reactive frequencies for the population. Dotted vertical lines at 8 Hz and 13 Hz mark the range of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e009" xlink:type="simple"/></inline-formula>-band. Note: For S6 in left column the blue line exceeds the shown range to reach the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e010" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0077536.g004" position="float" xlink:type="simple"/></fig>
<p>The nSNR measure gives ratios of power at the stimulation frequency to the mean power at adjacent frequencies. This makes it less sensitive to the fact that with the increase of frequency the measured bioelectrical brain activity is more attenuated. As a result for most of the subjects we observe slower decrease of the SSVEP response with frequency, and in general the response curve is much more leveled (cf. <xref ref-type="fig" rid="pone-0077536-g004">Fig. 4</xref> right vs left panel in each row). The response curve averaged over subjects (<xref ref-type="fig" rid="pone-0077536-g004">Fig. 4</xref> bottom panel) reveals that there is a broad peak ranging from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e086" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e087" xlink:type="simple"/></inline-formula> band, with its peak located around 16 Hz. With respect to the average response measured by normalized spectral power the peak is shifted from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e088" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e089" xlink:type="simple"/></inline-formula> band.</p>
</sec><sec id="s3b2">
<title>Reactive frequencies</title>
<p>We performed two levels of statistical tests. The first level, within subjects, seeks an answer: at which of the stimulation frequencies the response evaluated by given measure (either <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e090" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e091" xlink:type="simple"/></inline-formula>) is higher for the VS than for the NVS epochs. For this test we applied one sided Wilcoxon test with False Discovery Rate (FDR) <xref ref-type="bibr" rid="pone.0077536-Benjamini1">[25]</xref> correction for multiple comparison; the maximum FDR level (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e092" xlink:type="simple"/></inline-formula>-value) was set to 5%. From this level of analysis for each subject we obtain list of frequencies for which the null hypothesis was rejected. This are subject's reactive frequencies.</p>
<p>The second level, between subjects, seeks an answer whether a given stimulation frequency is reactive in the population, i.e. can we reject the hypothesis that for the considered frequency the given measure yields higher result for the VS than for the NVS epochs in not more than half of the population. We treat the first level test results for given frequency across subjects as a Bernoulli process (with sequence of length equal to the number of subjects and number of successes equal to the number of subjects for whom the considered frequency is the reactive one). We compute the probability of obtaining such or more extreme sequence from Bernoulli distribution with parameter equal to 0.5 and correct it for multiple comparison with FDR (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e093" xlink:type="simple"/></inline-formula>-level<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e094" xlink:type="simple"/></inline-formula>%).</p>
<p>In <xref ref-type="fig" rid="pone-0077536-g004">Fig. 4</xref> in rows 1–10, the significant – according to the within-subject level tests – SSVEP responses are marked in gray. The results show that normalized spectral power measure does not detect the significant SSVEP response only for subject S6 for stimulation frequencies within <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e095" xlink:type="simple"/></inline-formula> band, and for subject S1 in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e096" xlink:type="simple"/></inline-formula> band. The last row shows the mean responses averaged across subjects. In this panel, the gray bars indicate significant results of the second level statistical test. We see that for all tested frequencies the hypothesis that SSVEP reaction will be significant in not more than half of the population can be rejected. In this sense, we can state that all frequencies are reactive according to both spectral power and SNR measure.</p>
</sec></sec><sec id="s3c">
<title>Optimal frequencies</title>
<p>The next, more detailed question is which frequency range, on the population level, is optimal for SSVEP detection. The optimality criteria applied is that the response is the largest and similar for different frequencies within a contiguous range. To tackle this problem we performed a series of paired <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e097" xlink:type="simple"/></inline-formula>-tests. Each test compares <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e098" xlink:type="simple"/></inline-formula> responses obtained for two different frequencies of stimulation for the group of subjects. The results shown in <xref ref-type="fig" rid="pone-0077536-g005">Fig. 5</xref> were corrected for multiple comparisons by means of FDR (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e099" xlink:type="simple"/></inline-formula>). In this plot white pixel indicates a pair of stimulation frequencies (one from horizontal, and one from vertical axis) which do not yield significant differences in mean nSNR response, black pixel indicates that the difference is significant. One can notice, that there are contiguous, partially overlapping, frequency ranges which pairwise have equal mean responses. We selected four ranges of stimulation frequencies which are large and contiguous, marked by color squares. The next step was to find out which of these contiguous frequency range has the highest nSNR<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e100" xlink:type="simple"/></inline-formula> to fulfill our optimality criterion. One way ANOVA reveals that the mean nSNR<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e101" xlink:type="simple"/></inline-formula> in these ranges are not equal (F<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e102" xlink:type="simple"/></inline-formula> = 33.6, p = 2e–18). According to post-hoc test (Tukey HSD) we can state that at the significance level 5%(corrected) the mean nSNR<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e103" xlink:type="simple"/></inline-formula> are different between each pair of the ranges (<xref ref-type="fig" rid="pone-0077536-g006">Fig. 6</xref>) except 8–14 Hz and 18–23 Hz. Thus the frequency bands can be ordered according to mean nSNR value in the following way: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e104" xlink:type="simple"/></inline-formula></p>
<fig id="pone-0077536-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0077536.g005</object-id><label>Figure 5</label><caption>
<title>Test of magnitude of nSNR response for pairs of frequencies.</title>
<p>White pixel indicate a pair of stimulation frequencies (one from horizontal, and one from vertical axis) which do not show significant differences in mean nSNR response, black pixel indicates that the difference is significant. Color squares indicate contiguous frequency ranges which pairwise have equal mean responses.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0077536.g005" position="float" xlink:type="simple"/></fig><fig id="pone-0077536-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0077536.g006</object-id><label>Figure 6</label><caption>
<title>Distribution of nSNR responses in selected frequency ranges.</title>
<p>Each box-plot shows median (middle red line) together with its 95% confidence interval (notches). The lower and upper edge indicate 25<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e012" xlink:type="simple"/></inline-formula> and 75<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e013" xlink:type="simple"/></inline-formula> quantile, the whiskers show the span the data.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pone.0077536.g006" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s4">
<title>Discussion</title>
<sec id="s4a">
<title>Realistic design of the experiment</title>
<sec id="s4a1">
<title>Paradigm</title>
<p>The experimental paradigms found in the SSVEP literature (e.g. <xref ref-type="bibr" rid="pone.0077536-Pastor1">[5]</xref>, <xref ref-type="bibr" rid="pone.0077536-Herrmann1">[6]</xref>) were limited to the long term stimulation with randomly selected frequencies, separated by short breaks. Such conditions are not realistic in a BCI system. The typical mode of operation of a BCI system consists of periods, when the subject focuses attention on the flickering light, and periods when he or she observes the BCI feedback or results of the selected action. This is true for both synchronous and asynchronous BCI systems. In this respect, proposed paradigm composed of stimulation epochs (VS) interleaved with the resting periods (NVS) seems more appropriate.</p>
</sec><sec id="s4a2">
<title>Number of flickering fields</title>
<p>In spite of claiming to investigate the properties of the SSVEP with the aim of improving SSVEP-based BCI, most of the reported studies were based upon unrealistic paradigm where the measures of the SSVEP response concerned the EEG activity recorded during stimulation with only one flickering light source <xref ref-type="bibr" rid="pone.0077536-Regan2">[3]</xref>, <xref ref-type="bibr" rid="pone.0077536-Pastor1">[5]</xref>, <xref ref-type="bibr" rid="pone.0077536-Herrmann1">[6]</xref>, <xref ref-type="bibr" rid="pone.0077536-Bakardjian1">[26]</xref>, <xref ref-type="bibr" rid="pone.0077536-Kaashoek1">[27]</xref>. The main objective of the presented study is determination of the SSVEP frequency response in the experimental condition involving the possible interference of neighboring, relatively large, flickering fields. In contrast to the previous studies, results presented here were obtained with a real BCI appliance <xref ref-type="bibr" rid="pone.0077536-Durka1">[13]</xref>. In the presented paradigm each filed flickered with different, randomly selected frequency. Some of the attended frequencies have greater chance to occur together with the unattended frequencies having one of the harmonics equal to the attended one. For example one may consider attended stimulus 24 Hz which can be presented with the unattended stimuli 6, 8, 12 Hz which have a harmonic equal to 24 Hz in contrast to attended stimulus 23 Hz which has no unattended frequency with harmonics equal 23 Hz. A priori, it could be assumed that the frequencies which have many possibilities to be stimulated simultaneously with harmonically related neighbors would evoke different SSVEP response than those which have no such possibilities. But for the tested BCI appliance and methods of SSVEP evaluation, there is no visible interference from the not attended harmonically related frequencies. Careful inspection of <xref ref-type="fig" rid="pone-0077536-g004">Fig. 4</xref> and <xref ref-type="fig" rid="pone-0077536-g005">5</xref> shows that frequencies which have higher chance to occur together with harmonically related frequencies don't exhibit visibly stronger responses.</p>
</sec></sec><sec id="s4b">
<title>Measuring the SSVEP response</title>
<sec id="s4b1">
<title>Derivation selection</title>
<p>The issue of an electrode montage optimal for SSVEP measurement was not unequivocally solved so far. In order to identify the electrode with the best SSVEP response, different techniques were used by different authors, e.g. averaging the signals from occipital leads (O1, Oz, O2) <xref ref-type="bibr" rid="pone.0077536-Pastor1">[5]</xref> or searching for the best bipolar combination of the occipital lead and some other electrode <xref ref-type="bibr" rid="pone.0077536-Wang1">[4]</xref>. Following Molina <xref ref-type="bibr" rid="pone.0077536-Molina1">[28]</xref> we propose to measure the SSVEP response in the channel of CSP filtered signals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e105" xlink:type="simple"/></inline-formula> which corresponds to the greatest eigenvalue of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e106" xlink:type="simple"/></inline-formula>. This channel is characterized by maximal variance for the time-series of interest and minimal variance for the time-series regarded as noise. The spatial patterns obtained for such selected channel are in most cases compatible with a presumed dipole in the visual cortex.</p>
<p>We showed that the selected spatial patten vary with stimulation frequencies (only four subject out of ten had the stable spatial pattern, independent of the stimulation frequencies). But even for the cases when the spatial patterns are independent of the stimulation frequencies, the spatial filters may vary with frequency due to different spatial distribution of background EEG activity in different frequency bands. These results suggest that the separate spatial filters should be estimated at least for the stimulation frequency ranges corresponding to different EEG rhythms.</p>
</sec><sec id="s4b2">
<title>Quantification of SSVEP</title>
<p>The response due to a flickering stimulation is mixed with the ongoing EEG activity. Thus the prerequisite to quantify the response is to separate it from the background activity. Measures of SSVEP proposed in <xref ref-type="bibr" rid="pone.0077536-Regan2">[3]</xref>, <xref ref-type="bibr" rid="pone.0077536-Pastor1">[5]</xref>, <xref ref-type="bibr" rid="pone.0077536-Herrmann1">[6]</xref> use time-locked averaging technique to suppress the background EEG activity. This method, although widely used in evoked potential research, is not very useful in a BCI setup, since it requires a sizable number of realizations to be effective.</p>
<p>The general signal processing techniques involving the frequency and spatial filtering to improve the signal-to-noise ratio can be used in the pre-processing stage, but at the next stage it is essential to construct a measure which is sensitive and specific to the activity resulting from the stimulation. There are two general approaches to quantification of the SSVEP. The first one is to use the amplitude of the spectral peak at the stimulation frequency. This can be obtained by autoregressive modeling <xref ref-type="bibr" rid="pone.0077536-Herrmann1">[6]</xref> or Fourier analysis <xref ref-type="bibr" rid="pone.0077536-Wang1">[4]</xref>, <xref ref-type="bibr" rid="pone.0077536-Pastor1">[5]</xref>. The spectral amplitudes are then corrected for a typical EEG spectrum profile: e.g. by multiplying the results by the frequency <xref ref-type="bibr" rid="pone.0077536-Pastor1">[5]</xref>. The other one relies on constructing derived measures, e.g. the ratio of spectral power at the stimulation frequency to the average power in adjacent frequencies <xref ref-type="bibr" rid="pone.0077536-Wang1">[4]</xref>. We showed that the range of frequencies which evoke most pronounced response depends to some extent on the applied response measure. For the population, average normalized spectral power measure <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e107" xlink:type="simple"/></inline-formula> has maximum in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e108" xlink:type="simple"/></inline-formula> band while the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e109" xlink:type="simple"/></inline-formula> has the maximum in the low-<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e110" xlink:type="simple"/></inline-formula> band. This discrepancy comes from the fact that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e111" xlink:type="simple"/></inline-formula> measure is affected by three factors: one is the activity induced by stimulation, the second is the attenuation of EEG amplitude with frequency, and the third one is the modulation of the background activity due to stimulation. The consequences of the second and third factors are reduced to great extent in case of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e112" xlink:type="simple"/></inline-formula> measure.</p>
</sec></sec><sec id="s4c">
<title>Comparison of responses in different stimulating frequency</title>
<p>In this paper we investigated the responses to stimulation by light flickering with frequency in the 5–30 Hz range. The sensitivity of the brain to particular frequency as reflected by SSVEP frequency response curve was not uniform across frequencies and its exact shape depended on the method used to quantify the response, and on the subjects.</p>
<p>Our results are in agreement with other results reported in the literature, concerning SSVEP responses. Regan <xref ref-type="bibr" rid="pone.0077536-Regan2">[3]</xref> has shown that the amplitudes of SSVEP exhibit resonant-like peaks in three frequency regions, with peak frequencies around 10 Hz, 20 Hz and 50 Hz. In our study only two first peaks are present as the range of frequencies investigated was limited to 5–30 Hz. It should be noted that these peaks are rather seen in individual subjects than in the group average. Pastor et al <xref ref-type="bibr" rid="pone.0077536-Pastor1">[5]</xref> has analyzed SSVEP responses to flicker stimulation in the 5–60 Hz range. They found that response reached a maximum at 15 Hz in occipital regions and at 25 Hz in frontal regions. The occipital maximum is in agreement with the one reported in our study, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e113" xlink:type="simple"/></inline-formula> method. Analogous result was also presented for one subject in <xref ref-type="bibr" rid="pone.0077536-Wang1">[4]</xref>.</p>
<p>Herrmann <xref ref-type="bibr" rid="pone.0077536-Herrmann1">[6]</xref> reported that the SSVEP responses exhibit resonance phenomena around 10, 20, 40 and 80 Hz. It has been shown in single subjects, by means of comparing responses to a given resonant frequency and two adjacent frequencies. Dominant responses at resonant frequencies were apparent in the power spectra and in their larger amplitude as compared to response amplitudes at both adjacent frequencies. In our study, the power spectra of the individual subjects don't point to the resonance properties of the brain, described above.</p>
<p>Of the two quantification methods studied in this paper the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e114" xlink:type="simple"/></inline-formula> measure is more selective to the SSVEP phenomenon as explained above. Thus further statistical analysis were performed only for responses measured with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e115" xlink:type="simple"/></inline-formula>. All the studied stimulation frequencies evoked response, yielding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0077536.e116" xlink:type="simple"/></inline-formula> for VS epochs significantly higher than for NVS epochs. Using pair-wise tests we found contiguous, partially overlapping, frequency ranges with equal mean nSNR responses. The nSNR response, grouped in these ranges, have different group means. From the presented results it follows that the most effective frequencies evoking the largest SSVEP response belong to the frequency band of 12–18 Hz.</p>
</sec></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pone.0077536-Regan1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Regan</surname><given-names>D</given-names></name> (<year>1968</year>) <article-title>A high frequency mechanism which underlies visual evoked potentials</article-title>. <source>Electroencephalography and Clinical Neurophysiology</source> <volume>25(3)</volume>: <fpage>231</fpage>–<lpage>257</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Brunner1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brunner</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Allison</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Altstätter</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Neuper</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>A comparison of three brain-computer interfaces based on event-related desynchronization, steady state visual evoked potentials, or a hybrid approach using both signals</article-title>. <source>Journal of Neural Engineering</source> <volume>8</volume><supplement>(2)</supplement>: <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1741-2560/8/2/025010" xlink:type="simple">10.1088/1741-2560/8/2/025010</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0077536-Regan2"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Regan</surname><given-names>D</given-names></name> (<year>1975</year>) <article-title>Recent advances in electrical recording from the human brain</article-title>. <source>Nature</source> <volume>6(253)</volume>: <fpage>401</fpage>–<lpage>407</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Wang1"><label>4</label>
<mixed-citation publication-type="other" xlink:type="simple">Wang Y, Wang R, Gao X, Gao S (2005) Brain-computer Interface based on the High-frequency Steady-state Visual Evoked Potential. In: First International Conference on Neural Interface and Control Proceedings.</mixed-citation>
</ref>
<ref id="pone.0077536-Pastor1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pastor</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Artieda</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Arbizu</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Masdeu</surname><given-names>J</given-names></name> (<year>2003</year>) <article-title>Human cerebral activation during steady-state visual-evoked responses</article-title>. <source>Journal of Neuroscience</source> <volume>23(37)</volume>: <fpage>621</fpage>–<lpage>627</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Herrmann1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Herrmann</surname><given-names>CS</given-names></name> (<year>2001</year>) <article-title>Human EEG responses to 1-100 Hz flicker: resonance phenomena in visual cortex and their potential correlation to cognitive phenomena</article-title>. <source>Experimental Brain Research</source> <volume>137(3–4)</volume>: <fpage>346</fpage>–<lpage>353</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Cecotti1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cecotti</surname><given-names>H</given-names></name> (<year>2010</year>) <article-title>A Self-Paced and Calibration-Less SSVEP-Based Brain-Computer Interface Speller</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source> <volume>18(2)</volume>: <fpage>127</fpage>–<lpage>133</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Hwang1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hwang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Jung</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Choik</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Im</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Development of an SSVEP-based BCI spelling system adopting a QWERTY-style LED keyboard</article-title>. <source>Journal of Neuroscience Methods</source> <volume>208(1)</volume>: <fpage>59</fpage>–<lpage>65</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-LopezGordo1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lopez-Gordo</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Prieto</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Pelayo</surname><given-names>F</given-names></name>, <name name-style="western"><surname>C</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Customized stimulation enhances performance of independent binary SSVEP-BCI</article-title>. <source>Clinical Neurophysiology</source> <volume>122(1)</volume>: <fpage>128</fpage>–<lpage>133</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Lin1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>CMI</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Gao</surname><given-names>X</given-names></name> (<year>2007</year>) <article-title>Frequency Recognition Based on Canonical Correlation analysis for SSVEP-Based BCIs</article-title>. <source>IEEE Transactions on Biomedical Engineering</source> <volume>54</volume>: <fpage>1172</fpage>–<lpage>1176</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-MullerPutz1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muller-Putz</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Scherer</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Brauneis</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Pfurtscheller</surname><given-names>G</given-names></name> (<year>2005</year>) <article-title>Steady-state visual evoked potential (SSVEP)-based communication: impact of harmonic frequency components</article-title>. <source>Journal of Neural Engineering</source> <volume>2</volume>: <fpage>123</fpage>–<lpage>130</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Volosyak1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Volosyak</surname><given-names>I</given-names></name> (<year>2011</year>) <article-title>SSVEP based Bremen BCI interface-boosting information transfer rates</article-title>. <source>Journal of Neural Engineering</source> <volume>8(3)</volume>: <fpage>10.1088/1741</fpage>–<lpage>2560/8/3/036020</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Durka1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Durka</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Kus</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Zygierewicz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Michalska</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Milanowski</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>User-centered design of brain-computer interfaces: OpenBCI.pl and BCI Appliance</article-title>. <source>Bulletin of the Polish Academy of Sciences, Technical Sciences</source> <volume>60(3)</volume>: <fpage>427</fpage>–<lpage>431</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Fuchs1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuchs</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Andersen</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gruber</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Müller</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Attentional bias of competitive interactions in neuronal networks of early visual processing in the human brain</article-title>. <source>Neuroimage</source> <volume>41(3)</volume>: <fpage>1086</fpage>–<lpage>101</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Ng1"><label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Ng K, Bradley A, Cunnington R (2011) Effect of competing stimuli on SSVEP-based BCI. In: Engineering in Medicine and Biology Society, EMBC, 2011 Annual International Conference of the IEEE.</mixed-citation>
</ref>
<ref id="pone.0077536-Ng2"><label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Ng K, Bradley A, Cunnington R (2012) Stimulus specificity of a steady-state visual-evoked potential-based brain-computer interface. Journal of Neural engineering 9(3): doi 036008.</mixed-citation>
</ref>
<ref id="pone.0077536-Koles1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koles</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Lazar S MSand</surname><given-names>Zhou</given-names></name> (<year>1990</year>) <article-title>Spatial patterns underlying population differences in the background EEG</article-title>. <source>Brain Topography</source> <volume>2(4)</volume>: <fpage>275</fpage>–<lpage>284</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Koles2"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koles</surname><given-names>Z</given-names></name> (<year>1991</year>) <article-title>The quantitative extraction and topographic mapping of the abnormal components in the clinical eeg</article-title>. <source>Electroencephalography and Clinical Neurophysiology</source> <volume>79</volume>: <fpage>440</fpage>–<lpage>447</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Koles3"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koles</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Lind</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Flor-Henry</surname><given-names>P</given-names></name> (<year>1994</year>) <article-title>Spatial patterns in the background EEG underlying mental disease in man</article-title>. <source>Electroencephalography and Clinical Neurophysiology</source> <volume>91</volume>: <fpage>319</fpage>–<lpage>328</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Koles4"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koles</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Lind</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Soong</surname><given-names>A</given-names></name> (<year>1995</year>) <article-title>Spatio-temporal decomposition of the EEG: a general approach to the isolation and localization of sources</article-title>. <source>Electroencephalography and Clinical Neurophysiology</source> <volume>95</volume>: <fpage>219</fpage>–<lpage>230</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Fukunaga1"><label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Fukunaga K (1990) Introduction to Statistical Pattern Recognition. Academic Press; 2 edition.</mixed-citation>
</ref>
<ref id="pone.0077536-Makeig1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Makeig</surname><given-names>S</given-names></name> (<year>1993</year>) <article-title>Auditory Event-Related Dynamics of the EEG Spectrum and Effects of Exposure to Tones</article-title>. <source>Electroencephalography and Clinical Neurophysiology</source> <volume>86</volume>: <fpage>283</fpage>–<lpage>293</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Wang2"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gao</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Hong</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Gao</surname><given-names>S</given-names></name> (<year>2006</year>) <article-title>A practical VEP-based brain-computer interface</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source> <volume>2</volume>: <fpage>234</fpage>–<lpage>240</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Niedermeyer1"><label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Niedermeyer E, da Silva FL (2005) Electroencephalography: Basic Principles, Clinical Applications and Related Fields. Philadelphia: Lippincott Williams and Wilkins.</mixed-citation>
</ref>
<ref id="pone.0077536-Benjamini1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yekutieli</surname><given-names>D</given-names></name> (<year>2001</year>) <article-title>The control of the False Discovery Rate Under Dependancy</article-title>. <source>Annals of Statistics</source> <volume>29</volume>: <fpage>1165</fpage>–<lpage>1188</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Bakardjian1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bakardjian</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Tanaka</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Cichocki</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Optimization of SSVEP brain responses with application to eight-command Brain-Computer Interface</article-title>. <source>Neuroscience Letters</source> <volume>469</volume>: <fpage>34</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pone.0077536-Kaashoek1"><label>27</label>
<mixed-citation publication-type="other" xlink:type="simple">Kaashoek I (2008) Automatic determination of the optimum stimulation frequencies in an SSVEP based BCI. Technical report, Koninklijke Philips Electronics N.V.</mixed-citation>
</ref>
<ref id="pone.0077536-Molina1"><label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Molina GM, Zhu D, Abtahi S (2010) Phase detection in a visual-evoked-potential based brain computer interface. In: 18th European Signal Processing Conference (EUSIPCO-2010), Aalborg, Denmark, August 23–27.</mixed-citation>
</ref>
</ref-list></back>
</article>